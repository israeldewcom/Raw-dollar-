<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raw Wealthy Admin Dashboard v4.0 - Enterprise Edition</title>
    
    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Date Range Picker -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
    
    <style>
        :root {
            /* Primary Colors */
            --primary: #667eea;
            --primary-dark: #764ba2;
            --primary-light: rgba(102, 126, 234, 0.1);
            
            /* Secondary Colors */
            --secondary: #10b981;
            --secondary-dark: #059669;
            --secondary-light: rgba(16, 185, 129, 0.1);
            
            /* Status Colors */
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            
            /* Neutral Colors */
            --dark: #1f2937;
            --dark-2: #374151;
            --dark-3: #4b5563;
            --light: #f9fafb;
            --light-2: #f3f4f6;
            --light-3: #e5e7eb;
            --white: #ffffff;
            --gray: #6b7280;
            --gray-light: #9ca3af;
            --border: #d1d5db;
            
            /* Sizes & Spacing */
            --sidebar-width: 280px;
            --sidebar-collapsed: 80px;
            --header-height: 70px;
            --border-radius: 12px;
            --border-radius-sm: 8px;
            --border-radius-xs: 6px;
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            
            /* Transitions */
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-fast: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Z-index layers */
            --z-sidebar: 100;
            --z-header: 200;
            --z-modal: 1000;
            --z-dropdown: 300;
            --z-tooltip: 400;
            --z-toast: 5000;
        }

        /* Reset & Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--light);
            color: var(--dark);
            line-height: 1.6;
            font-size: 14px;
            overflow-x: hidden;
        }

        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--light-2);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gray-light);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--gray);
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 600;
            line-height: 1.2;
            margin-bottom: 0.5em;
        }

        h1 { font-size: 2rem; }
        h2 { font-size: 1.5rem; }
        h3 { font-size: 1.25rem; }
        h4 { font-size: 1.125rem; }

        .text-xs { font-size: 0.75rem; }
        .text-sm { font-size: 0.875rem; }
        .text-base { font-size: 1rem; }
        .text-lg { font-size: 1.125rem; }
        .text-xl { font-size: 1.25rem; }
        .text-2xl { font-size: 1.5rem; }
        .text-3xl { font-size: 1.875rem; }
        .text-4xl { font-size: 2.25rem; }

        .font-light { font-weight: 300; }
        .font-normal { font-weight: 400; }
        .font-medium { font-weight: 500; }
        .font-semibold { font-weight: 600; }
        .font-bold { font-weight: 700; }
        .font-extrabold { font-weight: 800; }

        /* Utility Classes */
        .hidden { display: none !important; }
        .block { display: block; }
        .inline-block { display: inline-block; }
        .flex { display: flex; }
        .inline-flex { display: inline-flex; }
        .grid { display: grid; }
        .contents { display: contents; }

        .items-center { align-items: center; }
        .items-start { align-items: flex-start; }
        .items-end { align-items: flex-end; }
        .justify-center { justify-content: center; }
        .justify-between { justify-content: space-between; }
        .justify-end { justify-content: flex-end; }
        .flex-col { flex-direction: column; }
        .flex-row { flex-direction: row; }
        .flex-wrap { flex-wrap: wrap; }
        .flex-1 { flex: 1 1 0%; }
        .flex-auto { flex: 1 1 auto; }
        .flex-none { flex: none; }

        .gap-1 { gap: 0.25rem; }
        .gap-2 { gap: 0.5rem; }
        .gap-3 { gap: 0.75rem; }
        .gap-4 { gap: 1rem; }
        .gap-6 { gap: 1.5rem; }
        .gap-8 { gap: 2rem; }

        .p-2 { padding: 0.5rem; }
        .p-3 { padding: 0.75rem; }
        .p-4 { padding: 1rem; }
        .p-6 { padding: 1.5rem; }
        .p-8 { padding: 2rem; }

        .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
        .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
        .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
        .py-4 { padding-top: 1rem; padding-bottom: 1rem; }

        .m-0 { margin: 0; }
        .m-2 { margin: 0.5rem; }
        .m-4 { margin: 1rem; }
        .mx-auto { margin-left: auto; margin-right: auto; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-3 { margin-bottom: 0.75rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-8 { margin-bottom: 2rem; }
        .ml-auto { margin-left: auto; }
        .mr-auto { margin-right: auto; }

        .w-full { width: 100%; }
        .w-1\/2 { width: 50%; }
        .w-1\/3 { width: 33.333333%; }
        .w-2\/3 { width: 66.666667%; }
        .w-1\/4 { width: 25%; }
        .w-3\/4 { width: 75%; }
        .w-auto { width: auto; }
        .max-w-full { max-width: 100%; }
        .max-w-screen-md { max-width: 768px; }
        .max-w-screen-lg { max-width: 1024px; }
        .max-w-screen-xl { max-width: 1280px; }

        .h-full { height: 100%; }
        .h-screen { height: 100vh; }
        .min-h-screen { min-height: 100vh; }
        .min-h-0 { min-height: 0; }

        .rounded { border-radius: var(--border-radius-xs); }
        .rounded-md { border-radius: var(--border-radius-sm); }
        .rounded-lg { border-radius: var(--border-radius); }
        .rounded-full { border-radius: 9999px; }

        .border { border: 1px solid var(--border); }
        .border-0 { border: 0; }
        .border-t { border-top: 1px solid var(--border); }
        .border-b { border-bottom: 1px solid var(--border); }
        .border-l { border-left: 1px solid var(--border); }
        .border-r { border-right: 1px solid var(--border); }

        .shadow { box-shadow: var(--shadow); }
        .shadow-md { box-shadow: var(--shadow-md); }
        .shadow-lg { box-shadow: var(--shadow-lg); }
        .shadow-xl { box-shadow: var(--shadow-xl); }
        .shadow-none { box-shadow: none; }

        .text-center { text-align: center; }
        .text-left { text-align: left; }
        .text-right { text-align: right; }

        .text-primary { color: var(--primary); }
        .text-secondary { color: var(--secondary); }
        .text-success { color: var(--success); }
        .text-warning { color: var(--warning); }
        .text-danger { color: var(--danger); }
        .text-info { color: var(--info); }
        .text-dark { color: var(--dark); }
        .text-gray { color: var(--gray); }
        .text-white { color: var(--white); }

        .bg-primary { background: var(--primary); }
        .bg-primary-light { background: var(--primary-light); }
        .bg-secondary { background: var(--secondary); }
        .bg-secondary-light { background: var(--secondary-light); }
        .bg-success { background: var(--success); }
        .bg-warning { background: var(--warning); }
        .bg-danger { background: var(--danger); }
        .bg-info { background: var(--info); }
        .bg-dark { background: var(--dark); }
        .bg-light { background: var(--light); }
        .bg-white { background: var(--white); }
        .bg-transparent { background: transparent; }

        .overflow-hidden { overflow: hidden; }
        .overflow-auto { overflow: auto; }
        .overflow-x-auto { overflow-x: auto; }
        .overflow-y-auto { overflow-y: auto; }

        .cursor-pointer { cursor: pointer; }
        .cursor-default { cursor: default; }
        .cursor-not-allowed { cursor: not-allowed; }

        .transition { transition: var(--transition); }
        .transition-slow { transition: var(--transition-slow); }
        .transition-fast { transition: var(--transition-fast); }

        .opacity-0 { opacity: 0; }
        .opacity-25 { opacity: 0.25; }
        .opacity-50 { opacity: 0.5; }
        .opacity-75 { opacity: 0.75; }
        .opacity-100 { opacity: 1; }

        .pointer-events-none { pointer-events: none; }
        .pointer-events-auto { pointer-events: auto; }

        .select-none { user-select: none; }
        .select-text { user-select: text; }

        .whitespace-nowrap { white-space: nowrap; }
        .whitespace-pre-wrap { white-space: pre-wrap; }

        .truncate {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Components */
        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.625rem 1.25rem;
            font-size: 0.875rem;
            font-weight: 500;
            line-height: 1;
            border-radius: var(--border-radius-sm);
            border: 1px solid transparent;
            cursor: pointer;
            transition: var(--transition);
            user-select: none;
            outline: none;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-sm {
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
        }

        .btn-lg {
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
        }

        .btn-block {
            width: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--white);
        }

        .btn-primary:hover:not(:disabled) {
            opacity: 0.9;
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--secondary);
            color: var(--white);
        }

        .btn-success {
            background: var(--success);
            color: var(--white);
        }

        .btn-danger {
            background: var(--danger);
            color: var(--white);
        }

        .btn-warning {
            background: var(--warning);
            color: var(--white);
        }

        .btn-info {
            background: var(--info);
            color: var(--white);
        }

        .btn-outline {
            background: transparent;
            border-color: var(--border);
            color: var(--dark);
        }

        .btn-outline:hover:not(:disabled) {
            background: var(--light);
            border-color: var(--gray-light);
        }

        .btn-outline-primary {
            background: transparent;
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn-outline-primary:hover:not(:disabled) {
            background: var(--primary-light);
        }

        .btn-ghost {
            background: transparent;
            border-color: transparent;
            color: var(--dark);
        }

        .btn-ghost:hover:not(:disabled) {
            background: var(--light);
        }

        /* Badges */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.625rem;
            font-size: 0.75rem;
            font-weight: 500;
            line-height: 1;
            border-radius: 9999px;
            white-space: nowrap;
        }

        .badge-sm {
            padding: 0.125rem 0.375rem;
            font-size: 0.625rem;
        }

        .badge-lg {
            padding: 0.375rem 0.875rem;
            font-size: 0.875rem;
        }

        .badge-primary {
            background: var(--primary-light);
            color: var(--primary);
        }

        .badge-secondary {
            background: var(--secondary-light);
            color: var(--secondary);
        }

        .badge-success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .badge-warning {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .badge-danger {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .badge-info {
            background: rgba(59, 130, 246, 0.1);
            color: var(--info);
        }

        .badge-gray {
            background: var(--light-3);
            color: var(--gray);
        }

        /* Cards */
        .card {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: var(--transition);
        }

        .card:hover {
            box-shadow: var(--shadow-md);
        }

        .card-header {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--light-3);
        }

        .card-body {
            padding: 1.5rem;
        }

        .card-footer {
            padding: 1.25rem 1.5rem;
            border-top: 1px solid var(--light-3);
        }

        /* Forms */
        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark);
        }

        .form-hint {
            display: block;
            margin-top: 0.375rem;
            font-size: 0.75rem;
            color: var(--gray);
        }

        .form-error {
            display: block;
            margin-top: 0.375rem;
            font-size: 0.75rem;
            color: var(--danger);
        }

        .form-control {
            display: block;
            width: 100%;
            padding: 0.625rem 0.875rem;
            font-size: 0.875rem;
            line-height: 1.5;
            color: var(--dark);
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: var(--border-radius-sm);
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        .form-control:disabled,
        .form-control[readonly] {
            background: var(--light);
            cursor: not-allowed;
        }

        .form-select {
            display: block;
            width: 100%;
            padding: 0.625rem 2.25rem 0.625rem 0.875rem;
            font-size: 0.875rem;
            line-height: 1.5;
            color: var(--dark);
            background: var(--white) url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23374151' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e") no-repeat right 0.875rem center/16px 12px;
            border: 1px solid var(--border);
            border-radius: var(--border-radius-sm);
            appearance: none;
            transition: var(--transition);
        }

        .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        .form-check {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }

        .form-check-input {
            width: 1rem;
            height: 1rem;
            border: 1px solid var(--border);
            border-radius: 0.25rem;
            background: var(--white);
            cursor: pointer;
        }

        .form-check-input:checked {
            background: var(--primary);
            border-color: var(--primary);
        }

        .form-check-input:focus {
            outline: none;
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        .form-check-label {
            font-size: 0.875rem;
            color: var(--dark);
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            border-radius: var(--border-radius);
            background: var(--white);
            box-shadow: var(--shadow);
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }

        .table th {
            padding: 1rem 1.25rem;
            font-weight: 600;
            text-align: left;
            color: var(--dark-3);
            background: var(--light);
            border-bottom: 1px solid var(--light-3);
            white-space: nowrap;
        }

        .table td {
            padding: 1rem 1.25rem;
            border-bottom: 1px solid var(--light-3);
            vertical-align: middle;
        }

        .table tbody tr:last-child td {
            border-bottom: 0;
        }

        .table tbody tr:hover {
            background: var(--light);
        }

        .table-compact th,
        .table-compact td {
            padding: 0.75rem 1rem;
        }

        /* Status Indicators */
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
        }

        .status-dot {
            width: 0.5rem;
            height: 0.5rem;
            border-radius: 50%;
        }

        .status-dot-success { background: var(--success); }
        .status-dot-warning { background: var(--warning); }
        .status-dot-danger { background: var(--danger); }
        .status-dot-info { background: var(--info); }
        .status-dot-primary { background: var(--primary); }
        .status-dot-gray { background: var(--gray); }

        /* Layout */
        .app-container {
            display: flex;
            min-height: 100vh;
            background: var(--light);
        }

        /* Login Page */
        .login-page {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            padding: 2rem;
        }

        .login-card {
            width: 100%;
            max-width: 400px;
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-xl);
            overflow: hidden;
        }

        .login-header {
            padding: 2rem;
            text-align: center;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--white);
        }

        .login-logo {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .login-body {
            padding: 2rem;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--dark);
            color: var(--white);
            display: flex;
            flex-direction: column;
            transition: var(--transition);
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            z-index: var(--z-sidebar);
        }

        .sidebar.collapsed {
            width: var(--sidebar-collapsed);
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--white);
            text-decoration: none;
        }

        .sidebar-logo-icon {
            font-size: 1.5rem;
        }

        .sidebar-logo-text {
            font-size: 1.25rem;
            font-weight: 700;
            transition: var(--transition);
        }

        .sidebar.collapsed .sidebar-logo-text {
            opacity: 0;
            width: 0;
            overflow: hidden;
        }

        .sidebar-nav {
            flex: 1;
            padding: 1rem 0;
            overflow-y: auto;
        }

        .nav-section {
            margin-bottom: 1.5rem;
        }

        .nav-section-title {
            padding: 0.5rem 1.5rem;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: rgba(255, 255, 255, 0.5);
            transition: var(--transition);
        }

        .sidebar.collapsed .nav-section-title {
            opacity: 0;
            height: 0;
            padding: 0;
            margin: 0;
            overflow: hidden;
        }

        .nav-item {
            list-style: none;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.5rem;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: var(--transition);
            position: relative;
        }

        .nav-link:hover,
        .nav-link.active {
            background: rgba(255, 255, 255, 0.1);
            color: var(--white);
        }

        .nav-link.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
        }

        .nav-icon {
            font-size: 1.125rem;
            width: 1.5rem;
            text-align: center;
        }

        .nav-text {
            transition: var(--transition);
        }

        .sidebar.collapsed .nav-text {
            opacity: 0;
            width: 0;
            overflow: hidden;
        }

        .nav-badge {
            margin-left: auto;
            background: var(--primary);
            color: var(--white);
            font-size: 0.75rem;
            padding: 0.125rem 0.375rem;
            border-radius: 9999px;
        }

        .sidebar-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .main-content.expanded {
            margin-left: var(--sidebar-collapsed);
        }

        /* Header */
        .header {
            height: var(--header-height);
            background: var(--white);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 1.5rem;
            position: sticky;
            top: 0;
            z-index: var(--z-header);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--dark);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Page Content */
        .page-content {
            flex: 1;
            padding: 1.5rem;
            overflow-y: auto;
        }

        /* Page Header */
        .page-header {
            margin-bottom: 1.5rem;
        }

        .page-header-actions {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .stat-icon {
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            flex-shrink: 0;
        }

        .stat-content {
            flex: 1;
            min-width: 0;
        }

        .stat-title {
            font-size: 0.875rem;
            color: var(--gray);
            margin-bottom: 0.25rem;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 0.25rem;
        }

        .stat-trend {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.75rem;
        }

        .stat-trend.up {
            color: var(--success);
        }

        .stat-trend.down {
            color: var(--danger);
        }

        /* Charts Grid */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .chart-card {
            background: var(--white);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .chart-header {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--light-3);
        }

        .chart-body {
            padding: 1.5rem;
            height: 300px;
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .action-card {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 1.25rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            text-decoration: none;
            color: var(--dark);
            transition: var(--transition);
            box-shadow: var(--shadow);
        }

        .action-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .action-icon {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.125rem;
            flex-shrink: 0;
        }

        .action-content {
            flex: 1;
            min-width: 0;
        }

        .action-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .action-desc {
            font-size: 0.875rem;
            color: var(--gray);
        }

        /* Activity Feed */
        .activity-feed {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .activity-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem;
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .activity-icon {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            flex-shrink: 0;
        }

        .activity-content {
            flex: 1;
            min-width: 0;
        }

        .activity-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .activity-desc {
            font-size: 0.875rem;
            color: var(--gray);
            margin-bottom: 0.5rem;
        }

        .activity-time {
            font-size: 0.75rem;
            color: var(--gray-light);
        }

        /* User Menu */
        .user-menu {
            position: relative;
        }

        .user-menu-toggle {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: var(--transition);
        }

        .user-menu-toggle:hover {
            background: var(--light);
        }

        .user-avatar {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-weight: 600;
            font-size: 0.875rem;
        }

        .user-info {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .user-name {
            font-weight: 600;
            font-size: 0.875rem;
        }

        .user-role {
            font-size: 0.75rem;
            color: var(--gray);
        }

        .user-menu-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            width: 240px;
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            z-index: var(--z-dropdown);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: var(--transition);
        }

        .user-menu.open .user-menu-dropdown {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .user-menu-header {
            padding: 1rem;
            border-bottom: 1px solid var(--light-3);
        }

        .user-menu-items {
            padding: 0.5rem 0;
        }

        .user-menu-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: var(--dark);
            text-decoration: none;
            transition: var(--transition);
        }

        .user-menu-item:hover {
            background: var(--light);
        }

        .user-menu-item-icon {
            width: 1rem;
            text-align: center;
            color: var(--gray);
        }

        .user-menu-item-text {
            flex: 1;
            font-size: 0.875rem;
        }

        /* Search */
        .search-box {
            position: relative;
            width: 240px;
        }

        .search-input {
            width: 100%;
            padding: 0.5rem 1rem 0.5rem 2.5rem;
            background: var(--light);
            border: 1px solid transparent;
            border-radius: var(--border-radius-sm);
            font-size: 0.875rem;
            transition: var(--transition);
        }

        .search-input:focus {
            outline: none;
            background: var(--white);
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        /* Notifications */
        .notifications {
            position: relative;
        }

        .notifications-toggle {
            width: 2.5rem;
            height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
        }

        .notifications-toggle:hover {
            background: var(--light);
        }

        .notifications-toggle.has-notifications::after {
            content: '';
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            width: 0.5rem;
            height: 0.5rem;
            background: var(--danger);
            border-radius: 50%;
            border: 2px solid var(--white);
        }

        .notifications-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            width: 320px;
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            z-index: var(--z-dropdown);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: var(--transition);
        }

        .notifications.open .notifications-dropdown {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .notifications-header {
            padding: 1rem;
            border-bottom: 1px solid var(--light-3);
        }

        .notifications-list {
            max-height: 320px;
            overflow-y: auto;
        }

        .notification-item {
            padding: 1rem;
            border-bottom: 1px solid var(--light-3);
            transition: var(--transition);
            cursor: pointer;
        }

        .notification-item:hover {
            background: var(--light);
        }

        .notification-item.unread {
            background: var(--primary-light);
        }

        .notification-icon {
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            margin-right: 0.75rem;
        }

        .notification-content {
            flex: 1;
            min-width: 0;
        }

        .notification-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .notification-message {
            font-size: 0.875rem;
            color: var(--gray);
            margin-bottom: 0.25rem;
        }

        .notification-time {
            font-size: 0.75rem;
            color: var(--gray-light);
        }

        .notifications-footer {
            padding: 0.75rem;
            text-align: center;
            border-top: 1px solid var(--light-3);
        }

        /* Modals */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: var(--z-modal);
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            padding: 1rem;
        }

        .modal.open {
            opacity: 1;
            visibility: visible;
        }

        .modal-dialog {
            width: 100%;
            max-width: 500px;
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-xl);
            transform: translateY(20px);
            transition: var(--transition);
        }

        .modal.open .modal-dialog {
            transform: translateY(0);
        }

        .modal-lg .modal-dialog {
            max-width: 800px;
        }

        .modal-xl .modal-dialog {
            max-width: 1140px;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--light-3);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-body {
            padding: 1.5rem;
            max-height: 60vh;
            overflow-y: auto;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--light-3);
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 0.75rem;
        }

        .modal-close {
            background: transparent;
            border: none;
            font-size: 1.25rem;
            color: var(--gray);
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 4px;
            transition: var(--transition);
        }

        .modal-close:hover {
            background: var(--light);
            color: var(--dark);
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--light-3);
            margin-bottom: 1.5rem;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            color: var(--gray);
            text-decoration: none;
            border-bottom: 2px solid transparent;
            transition: var(--transition);
            cursor: pointer;
        }

        .tab:hover {
            color: var(--dark);
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        /* Tooltips */
        .tooltip {
            position: absolute;
            padding: 0.5rem 0.75rem;
            background: var(--dark);
            color: var(--white);
            font-size: 0.75rem;
            border-radius: var(--border-radius-xs);
            white-space: nowrap;
            z-index: var(--z-tooltip);
            pointer-events: none;
            opacity: 0;
            visibility: hidden;
            transform: translateY(5px);
            transition: var(--transition);
        }

        .tooltip.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            z-index: var(--z-toast);
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            max-width: 400px;
        }

        .toast {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 1rem;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            box-shadow: var(--shadow-lg);
            animation: toastSlideIn 0.3s ease;
            transform: translateX(100%);
            animation-fill-mode: forwards;
        }

        @keyframes toastSlideIn {
            to {
                transform: translateX(0);
            }
        }

        .toast-icon {
            font-size: 1.25rem;
            flex-shrink: 0;
        }

        .toast.success .toast-icon {
            color: var(--success);
        }

        .toast.error .toast-icon {
            color: var(--danger);
        }

        .toast.warning .toast-icon {
            color: var(--warning);
        }

        .toast.info .toast-icon {
            color: var(--info);
        }

        .toast-content {
            flex: 1;
            min-width: 0;
        }

        .toast-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .toast-message {
            font-size: 0.875rem;
            color: var(--gray);
        }

        .toast-close {
            background: transparent;
            border: none;
            font-size: 1.25rem;
            color: var(--gray-light);
            cursor: pointer;
            padding: 0;
            width: 1.5rem;
            height: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: var(--transition);
        }

        .toast-close:hover {
            background: var(--light);
            color: var(--dark);
        }

        /* Loading */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: var(--z-modal);
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .loading-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .loading-spinner {
            width: 3rem;
            height: 3rem;
            border: 3px solid var(--light-3);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty States */
        .empty-state {
            text-align: center;
            padding: 3rem 1.5rem;
        }

        .empty-state-icon {
            width: 4rem;
            height: 4rem;
            border-radius: 50%;
            background: var(--light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--gray-light);
            margin: 0 auto 1rem;
        }

        .empty-state-title {
            font-size: 1.25rem;
            color: var(--dark);
            margin-bottom: 0.5rem;
        }

        .empty-state-description {
            color: var(--gray);
            margin-bottom: 1.5rem;
        }

        /* Pagination */
        .pagination {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.25rem;
            padding: 1rem;
        }

        .page-item {
            list-style: none;
        }

        .page-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: var(--border-radius-xs);
            background: var(--white);
            border: 1px solid var(--border);
            color: var(--dark);
            text-decoration: none;
            transition: var(--transition);
        }

        .page-link:hover {
            background: var(--light);
            border-color: var(--gray-light);
        }

        .page-item.active .page-link {
            background: var(--primary);
            border-color: var(--primary);
            color: var(--white);
        }

        .page-item.disabled .page-link {
            background: var(--light);
            color: var(--gray-light);
            cursor: not-allowed;
        }

        /* Progress Bars */
        .progress {
            height: 0.5rem;
            background: var(--light-3);
            border-radius: 9999px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: var(--primary);
            border-radius: 9999px;
            transition: width 0.6s ease;
        }

        /* Filter Bar */
        .filter-bar {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            background: var(--white);
            border-radius: var(--border-radius);
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
        }

        /* Date Range Picker */
        .daterangepicker {
            font-family: 'Inter', sans-serif;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.mobile-open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .main-content.expanded {
                margin-left: 0;
            }

            .mobile-menu-toggle {
                display: block;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 0 1rem;
            }

            .page-content {
                padding: 1rem;
            }

            .charts-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .quick-actions {
                grid-template-columns: 1fr;
            }

            .filter-bar {
                flex-direction: column;
                align-items: stretch;
            }

            .search-box {
                width: 100%;
            }

            .header-actions {
                display: none;
            }

            .header-actions.mobile-visible {
                display: flex;
            }
        }

        @media (max-width: 576px) {
            .modal-dialog {
                margin: 0.5rem;
            }

            .modal-header,
            .modal-body,
            .modal-footer {
                padding: 1rem;
            }

            .tabs {
                overflow-x: auto;
            }

            .tab {
                white-space: nowrap;
            }
        }

        /* Dark Mode Support */
        .dark-mode {
            --dark: #f9fafb;
            --dark-2: #e5e7eb;
            --dark-3: #d1d5db;
            --light: #111827;
            --light-2: #1f2937;
            --light-3: #374151;
            --white: #1f2937;
            --gray: #9ca3af;
            --gray-light: #6b7280;
            --border: #374151;
        }

        .dark-mode .card,
        .dark-mode .table-container,
        .dark-mode .stat-card,
        .dark-mode .chart-card,
        .dark-mode .action-card,
        .dark-mode .activity-item,
        .dark-mode .filter-bar {
            background: var(--light-2);
        }

        .dark-mode .table th {
            background: var(--light-3);
        }

        .dark-mode .modal-dialog {
            background: var(--light-2);
            color: var(--dark);
        }

        /* Print Styles */
        @media print {
            .sidebar,
            .header,
            .btn,
            .page-header-actions,
            .filter-bar {
                display: none !important;
            }

            .main-content {
                margin-left: 0;
            }

            .page-content {
                padding: 0;
            }

            .card {
                box-shadow: none;
                border: 1px solid var(--border);
            }

            .table {
                border: 1px solid var(--border);
            }
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="loginPage" class="login-page">
        <div class="login-card">
            <div class="login-header">
                <div class="login-logo">
                    <i class="fas fa-gem"></i>
                </div>
                <h1>Raw Wealthy Admin</h1>
                <p class="text-sm opacity-75">Enterprise Dashboard v4.0</p>
            </div>
            <div class="login-body">
                <div id="loginError" class="hidden mb-4 p-3 bg-danger-light text-danger rounded-md">
                    <i class="fas fa-exclamation-circle mr-2"></i>
                    <span id="errorMessage"></span>
                </div>
                <form id="loginForm">
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" id="loginEmail" class="form-control" placeholder="admin@rawwealthy.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" id="loginPassword" class="form-control" placeholder="••••••••" required>
                    </div>
                    <div class="form-group">
                        <div class="flex items-center justify-between">
                            <label class="form-check">
                                <input type="checkbox" id="rememberMe" class="form-check-input">
                                <span class="form-check-label">Remember me</span>
                            </label>
                            <a href="#" id="forgotPassword" class="text-sm text-primary">Forgot password?</a>
                        </div>
                    </div>
                    <button type="submit" id="loginButton" class="btn btn-primary btn-block">
                        <span id="loginButtonText">Sign In</span>
                        <span id="loginButtonSpinner" class="hidden">
                            <i class="fas fa-spinner fa-spin"></i>
                        </span>
                    </button>
                </form>
                <div class="mt-6 pt-6 border-t text-center">
                    <p class="text-sm text-gray">
                        Default credentials:<br>
                        admin@rawwealthy.com / Admin123456
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="appContainer" class="app-container hidden">
        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <a href="#" class="sidebar-logo">
                    <div class="sidebar-logo-icon">
                        <i class="fas fa-gem"></i>
                    </div>
                    <div class="sidebar-logo-text">Raw Wealthy</div>
                </a>
            </div>
            
            <div class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Main</div>
                    <ul class="nav-items">
                        <li class="nav-item">
                            <a href="#dashboard" class="nav-link active" data-page="dashboard">
                                <span class="nav-icon"><i class="fas fa-home"></i></span>
                                <span class="nav-text">Dashboard</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#analytics" class="nav-link" data-page="analytics">
                                <span class="nav-icon"><i class="fas fa-chart-line"></i></span>
                                <span class="nav-text">Analytics</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#reports" class="nav-link" data-page="reports">
                                <span class="nav-icon"><i class="fas fa-file-alt"></i></span>
                                <span class="nav-text">Reports</span>
                            </a>
                        </li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Management</div>
                    <ul class="nav-items">
                        <li class="nav-item">
                            <a href="#users" class="nav-link" data-page="users">
                                <span class="nav-icon"><i class="fas fa-users"></i></span>
                                <span class="nav-text">Users</span>
                                <span class="nav-badge" id="usersBadge">0</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#investments" class="nav-link" data-page="investments">
                                <span class="nav-icon"><i class="fas fa-chart-pie"></i></span>
                                <span class="nav-text">Investments</span>
                                <span class="nav-badge" id="investmentsBadge">0</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#deposits" class="nav-link" data-page="deposits">
                                <span class="nav-icon"><i class="fas fa-money-bill-wave"></i></span>
                                <span class="nav-text">Deposits</span>
                                <span class="nav-badge" id="depositsBadge">0</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#withdrawals" class="nav-link" data-page="withdrawals">
                                <span class="nav-icon"><i class="fas fa-wallet"></i></span>
                                <span class="nav-text">Withdrawals</span>
                                <span class="nav-badge" id="withdrawalsBadge">0</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#transactions" class="nav-link" data-page="transactions">
                                <span class="nav-icon"><i class="fas fa-exchange-alt"></i></span>
                                <span class="nav-text">Transactions</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#referrals" class="nav-link" data-page="referrals">
                                <span class="nav-icon"><i class="fas fa-user-friends"></i></span>
                                <span class="nav-text">Referrals</span>
                            </a>
                        </li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Verification</div>
                    <ul class="nav-items">
                        <li class="nav-item">
                            <a href="#kyc" class="nav-link" data-page="kyc">
                                <span class="nav-icon"><i class="fas fa-id-card"></i></span>
                                <span class="nav-text">KYC Verification</span>
                                <span class="nav-badge" id="kycBadge">0</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#support" class="nav-link" data-page="support">
                                <span class="nav-icon"><i class="fas fa-headset"></i></span>
                                <span class="nav-text">Support Tickets</span>
                                <span class="nav-badge" id="supportBadge">0</span>
                            </a>
                        </li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">System</div>
                    <ul class="nav-items">
                        <li class="nav-item">
                            <a href="#plans" class="nav-link" data-page="plans">
                                <span class="nav-icon"><i class="fas fa-cubes"></i></span>
                                <span class="nav-text">Investment Plans</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#settings" class="nav-link" data-page="settings">
                                <span class="nav-icon"><i class="fas fa-cog"></i></span>
                                <span class="nav-text">Settings</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#audit" class="nav-link" data-page="audit">
                                <span class="nav-icon"><i class="fas fa-history"></i></span>
                                <span class="nav-text">Audit Log</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#system-health" class="nav-link" data-page="systemHealth">
                                <span class="nav-icon"><i class="fas fa-heartbeat"></i></span>
                                <span class="nav-text">System Health</span>
                            </a>
                        </li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Advanced</div>
                    <ul class="nav-items">
                        <li class="nav-item">
                            <a href="#api-keys" class="nav-link" data-page="apiKeys">
                                <span class="nav-icon"><i class="fas fa-key"></i></span>
                                <span class="nav-text">API Keys</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#email-templates" class="nav-link" data-page="emailTemplates">
                                <span class="nav-icon"><i class="fas fa-envelope"></i></span>
                                <span class="nav-text">Email Templates</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#notifications" class="nav-link" data-page="notifications">
                                <span class="nav-icon"><i class="fas fa-bell"></i></span>
                                <span class="nav-text">Notifications</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="sidebar-footer">
                <div class="flex items-center justify-between">
                    <button id="toggleSidebar" class="btn btn-ghost btn-sm text-white">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="text-xs opacity-50">v4.0.0</div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main id="mainContent" class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <button id="mobileMenuToggle" class="btn btn-ghost mr-2 mobile-menu-toggle hidden">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 id="pageTitle" class="header-title">Dashboard</h1>
                </div>
                
                <div class="header-right">
                    <!-- Search -->
                    <div class="search-box hidden md:block">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" id="globalSearch" class="search-input" placeholder="Search...">
                    </div>
                    
                    <!-- Notifications -->
                    <div id="notifications" class="notifications">
                        <button class="notifications-toggle">
                            <i class="fas fa-bell"></i>
                        </button>
                        <div class="notifications-dropdown">
                            <div class="notifications-header flex items-center justify-between">
                                <h3 class="font-semibold">Notifications</h3>
                                <a href="#notifications" class="text-sm text-primary" onclick="navigateTo('notifications')">View All</a>
                            </div>
                            <div id="notificationsList" class="notifications-list">
                                <!-- Notifications will be loaded here -->
                            </div>
                            <div class="notifications-footer">
                                <button id="markAllRead" class="btn btn-ghost btn-sm">Mark all as read</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- User Menu -->
                    <div id="userMenu" class="user-menu">
                        <button class="user-menu-toggle">
                            <div id="userAvatar" class="user-avatar">A</div>
                            <div class="user-info hidden md:block">
                                <div id="userName" class="user-name">Admin</div>
                                <div id="userRole" class="user-role">Super Admin</div>
                            </div>
                            <i class="fas fa-chevron-down text-sm text-gray"></i>
                        </button>
                        <div class="user-menu-dropdown">
                            <div class="user-menu-header">
                                <div id="dropdownUserName" class="font-semibold">Admin User</div>
                                <div id="dropdownUserEmail" class="text-sm text-gray">admin@rawwealthy.com</div>
                            </div>
                            <div class="user-menu-items">
                                <a href="#profile" class="user-menu-item" onclick="navigateTo('profile')">
                                    <i class="fas fa-user user-menu-item-icon"></i>
                                    <span class="user-menu-item-text">My Profile</span>
                                </a>
                                <a href="#settings" class="user-menu-item" onclick="navigateTo('settings')">
                                    <i class="fas fa-cog user-menu-item-icon"></i>
                                    <span class="user-menu-item-text">Settings</span>
                                </a>
                                <a href="#security" class="user-menu-item" onclick="navigateTo('security')">
                                    <i class="fas fa-shield-alt user-menu-item-icon"></i>
                                    <span class="user-menu-item-text">Security</span>
                                </a>
                                <div class="user-menu-item">
                                    <i class="fas fa-moon user-menu-item-icon"></i>
                                    <span class="user-menu-item-text">Dark Mode</span>
                                    <div class="ml-auto">
                                        <input type="checkbox" id="darkModeToggle" class="form-check-input">
                                    </div>
                                </div>
                                <div class="border-t my-2"></div>
                                <a href="#" id="logoutButton" class="user-menu-item text-danger">
                                    <i class="fas fa-sign-out-alt user-menu-item-icon"></i>
                                    <span class="user-menu-item-text">Logout</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Page Content -->
            <div id="pageContent" class="page-content">
                <!-- Content will be dynamically loaded here -->
            </div>
        </main>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Modals (Dynamically created) -->
    
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
    
    <script>
        // ==================== CONFIGURATION ====================
        const CONFIG = {
            // Backend Configuration
            BACKEND_URL: window.location.hostname === 'localhost' 
                ? 'http://localhost:10000' 
                : 'https://real-wealthy-1.onrender.com',
            
            // API Endpoints (Full Integration)
            ENDPOINTS: {
                // Authentication
                LOGIN: '/api/auth/login',
                LOGOUT: '/api/auth/logout',
                PROFILE: '/api/profile',
                FORGOT_PASSWORD: '/api/auth/forgot-password',
                RESET_PASSWORD: '/api/auth/reset-password',
                
                // Users
                USERS: '/api/admin/users',
                USER_DETAILS: '/api/admin/users/{id}',
                UPDATE_USER_ROLE: '/api/admin/users/{id}/role',
                UPDATE_USER_STATUS: '/api/admin/users/{id}/status',
                CREATE_USER: '/api/auth/register',
                
                // Investments
                INVESTMENTS: '/api/investments',
                PENDING_INVESTMENTS: '/api/admin/pending-investments',
                INVESTMENT_DETAILS: '/api/admin/investments/{id}',
                APPROVE_INVESTMENT: '/api/admin/investments/{id}/approve',
                REJECT_INVESTMENT: '/api/admin/investments/{id}/reject',
                
                // Deposits
                DEPOSITS: '/api/deposits',
                PENDING_DEPOSITS: '/api/admin/pending-deposits',
                APPROVE_DEPOSIT: '/api/admin/deposits/{id}/approve',
                REJECT_DEPOSIT: '/api/admin/deposits/{id}/reject',
                
                // Withdrawals
                WITHDRAWALS: '/api/withdrawals',
                PENDING_WITHDRAWALS: '/api/admin/pending-withdrawals',
                APPROVE_WITHDRAWAL: '/api/admin/withdrawals/{id}/approve',
                REJECT_WITHDRAWAL: '/api/admin/withdrawals/{id}/reject',
                
                // Transactions
                TRANSACTIONS: '/api/transactions',
                ADMIN_TRANSACTIONS: '/api/admin/transactions',
                
                // KYC
                KYC_SUBMISSIONS: '/api/admin/pending-kyc',
                KYC_DETAILS: '/api/admin/kyc/{id}',
                APPROVE_KYC: '/api/admin/kyc/{id}/approve',
                REJECT_KYC: '/api/admin/kyc/{id}/reject',
                
                // Support
                SUPPORT_TICKETS: '/api/support/tickets',
                TICKET_DETAILS: '/api/admin/support/{id}',
                REPLY_TICKET: '/api/admin/support/{id}/reply',
                
                // Investment Plans
                PLANS: '/api/plans',
                CREATE_PLAN: '/api/admin/plans',
                UPDATE_PLAN: '/api/admin/plans/{id}',
                DELETE_PLAN: '/api/admin/plans/{id}',
                
                // Referrals
                REFERRAL_STATS: '/api/referrals/stats',
                REFERRAL_DETAILS: '/api/admin/referrals',
                
                // Notifications
                NOTIFICATIONS: '/api/notifications',
                MARK_NOTIFICATION_READ: '/api/notifications/{id}/read',
                MARK_ALL_READ: '/api/notifications/read-all',
                
                // Settings
                SYSTEM_SETTINGS: '/api/admin/settings',
                UPDATE_SETTINGS: '/api/admin/settings/update',
                
                // Dashboard
                DASHBOARD_STATS: '/api/admin/dashboard',
                ANALYTICS: '/api/admin/analytics',
                
                // Audit
                AUDIT_LOG: '/api/admin/audit',
                
                // System Health
                HEALTH: '/health',
                
                // Upload
                UPLOAD: '/api/upload'
            },
            
            // Application Settings
            APP_NAME: 'Raw Wealthy Admin',
            VERSION: 'v4.0.0',
            
            // Default Admin Credentials
            DEFAULT_ADMIN: {
                email: 'admin@rawwealthy.com',
                password: 'Admin123456'
            },
            
            // Cache Settings
            CACHE_TTL: 300000, // 5 minutes
            REFRESH_INTERVAL: 30000, // 30 seconds
            
            // Pagination
            ITEMS_PER_PAGE: 20,
            
            // Date Format
            DATE_FORMAT: 'YYYY-MM-DD',
            DATETIME_FORMAT: 'YYYY-MM-DD HH:mm:ss',
            
            // Currency
            CURRENCY: '₦',
            CURRENCY_CODE: 'NGN'
        };

        // ==================== APPLICATION STATE ====================
        const STATE = {
            // User
            token: localStorage.getItem('rawWealthyToken'),
            user: JSON.parse(localStorage.getItem('rawWealthyUser') || 'null'),
            
            // Navigation
            currentPage: 'dashboard',
            previousPage: null,
            pageTitle: 'Dashboard',
            
            // Data
            dataCache: new Map(),
            lastFetch: new Map(),
            charts: new Map(),
            
            // UI State
            sidebarCollapsed: localStorage.getItem('sidebarCollapsed') === 'true',
            darkMode: localStorage.getItem('darkMode') === 'true',
            
            // Notifications
            unreadNotifications: 0,
            
            // Loading
            isLoading: false,
            
            // Modals
            activeModal: null,
            
            // Search
            globalSearch: '',
            
            // Filters
            filters: {
                dateRange: {
                    start: moment().subtract(30, 'days').format(CONFIG.DATE_FORMAT),
                    end: moment().format(CONFIG.DATE_FORMAT)
                },
                status: null,
                type: null,
                search: ''
            }
        };

        // ==================== DOM ELEMENTS ====================
        const ELEMENTS = {
            // Login Page
            loginPage: document.getElementById('loginPage'),
            loginForm: document.getElementById('loginForm'),
            loginEmail: document.getElementById('loginEmail'),
            loginPassword: document.getElementById('loginPassword'),
            loginError: document.getElementById('loginError'),
            errorMessage: document.getElementById('errorMessage'),
            loginButton: document.getElementById('loginButton'),
            loginButtonText: document.getElementById('loginButtonText'),
            loginButtonSpinner: document.getElementById('loginButtonSpinner'),
            forgotPassword: document.getElementById('forgotPassword'),
            
            // Main App
            appContainer: document.getElementById('appContainer'),
            sidebar: document.getElementById('sidebar'),
            mainContent: document.getElementById('mainContent'),
            mobileMenuToggle: document.getElementById('mobileMenuToggle'),
            toggleSidebar: document.getElementById('toggleSidebar'),
            
            // Header
            pageTitle: document.getElementById('pageTitle'),
            globalSearch: document.getElementById('globalSearch'),
            
            // User Menu
            userMenu: document.getElementById('userMenu'),
            userAvatar: document.getElementById('userAvatar'),
            userName: document.getElementById('userName'),
            userRole: document.getElementById('userRole'),
            dropdownUserName: document.getElementById('dropdownUserName'),
            dropdownUserEmail: document.getElementById('dropdownUserEmail'),
            logoutButton: document.getElementById('logoutButton'),
            darkModeToggle: document.getElementById('darkModeToggle'),
            
            // Notifications
            notifications: document.getElementById('notifications'),
            notificationsList: document.getElementById('notificationsList'),
            markAllRead: document.getElementById('markAllRead'),
            
            // Page Content
            pageContent: document.getElementById('pageContent'),
            
            // Badges
            usersBadge: document.getElementById('usersBadge'),
            investmentsBadge: document.getElementById('investmentsBadge'),
            depositsBadge: document.getElementById('depositsBadge'),
            withdrawalsBadge: document.getElementById('withdrawalsBadge'),
            kycBadge: document.getElementById('kycBadge'),
            supportBadge: document.getElementById('supportBadge'),
            
            // Toast & Loading
            toastContainer: document.getElementById('toastContainer'),
            loadingOverlay: document.getElementById('loadingOverlay')
        };

        // ==================== UTILITY FUNCTIONS ====================
        class Utils {
            // Format Currency
            static formatCurrency(amount) {
                if (typeof amount !== 'number') amount = parseFloat(amount) || 0;
                return `${CONFIG.CURRENCY}${amount.toLocaleString('en-NG', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                })}`;
            }

            // Format Date
            static formatDate(date, format = CONFIG.DATE_FORMAT) {
                return moment(date).format(format);
            }

            // Format DateTime
            static formatDateTime(date, format = CONFIG.DATETIME_FORMAT) {
                return moment(date).format(format);
            }

            // Relative Time
            static timeAgo(date) {
                return moment(date).fromNow();
            }

            // Generate Random ID
            static generateId() {
                return Date.now().toString(36) + Math.random().toString(36).substr(2);
            }

            // Debounce
            static debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }

            // Throttle
            static throttle(func, limit) {
                let inThrottle;
                return function() {
                    const args = arguments;
                    const context = this;
                    if (!inThrottle) {
                        func.apply(context, args);
                        inThrottle = true;
                        setTimeout(() => inThrottle = false, limit);
                    }
                };
            }

            // Deep Clone
            static deepClone(obj) {
                return JSON.parse(JSON.stringify(obj));
            }

            // Get Status Color
            static getStatusColor(status) {
                const colors = {
                    'active': 'success',
                    'approved': 'success',
                    'verified': 'success',
                    'paid': 'success',
                    'completed': 'success',
                    'pending': 'warning',
                    'processing': 'warning',
                    'under_review': 'warning',
                    'rejected': 'danger',
                    'failed': 'danger',
                    'cancelled': 'danger',
                    'inactive': 'gray'
                };
                return colors[status] || 'gray';
            }

            // Get Status Icon
            static getStatusIcon(status) {
                const icons = {
                    'active': 'fa-check-circle',
                    'approved': 'fa-check-circle',
                    'verified': 'fa-check-circle',
                    'paid': 'fa-check-circle',
                    'completed': 'fa-check-circle',
                    'pending': 'fa-clock',
                    'processing': 'fa-sync-alt',
                    'under_review': 'fa-search',
                    'rejected': 'fa-times-circle',
                    'failed': 'fa-times-circle',
                    'cancelled': 'fa-ban',
                    'inactive': 'fa-circle'
                };
                return icons[status] || 'fa-circle';
            }

            // Validate Email
            static isValidEmail(email) {
                const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return re.test(email);
            }

            // Validate Phone
            static isValidPhone(phone) {
                const re = /^\+?[\d\s-]{10,}$/;
                return re.test(phone);
            }

            // Format File Size
            static formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            // Copy to Clipboard
            static copyToClipboard(text) {
                return new Promise((resolve, reject) => {
                    if (navigator.clipboard && window.isSecureContext) {
                        navigator.clipboard.writeText(text)
                            .then(resolve)
                            .catch(reject);
                    } else {
                        const textArea = document.createElement('textarea');
                        textArea.value = text;
                        textArea.style.position = 'fixed';
                        textArea.style.left = '-999999px';
                        textArea.style.top = '-999999px';
                        document.body.appendChild(textArea);
                        textArea.focus();
                        textArea.select();
                        try {
                            document.execCommand('copy');
                            resolve();
                        } catch (err) {
                            reject(err);
                        }
                        textArea.remove();
                    }
                });
            }

            // Download File
            static downloadFile(url, filename) {
                const link = document.createElement('a');
                link.href = url;
                link.download = filename;
                link.style.display = 'none';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }

            // Generate CSV
            static generateCSV(data, headers) {
                const csv = [
                    headers.join(','),
                    ...data.map(row => headers.map(header => {
                        const value = row[header];
                        return typeof value === 'string' ? `"${value.replace(/"/g, '""')}"` : value;
                    }).join(','))
                ].join('\n');
                
                return csv;
            }

            // Download CSV
            static downloadCSV(data, headers, filename) {
                const csv = this.generateCSV(data, headers);
                const blob = new Blob([csv], { type: 'text/csv' });
                const url = URL.createObjectURL(blob);
                this.downloadFile(url, filename);
                URL.revokeObjectURL(url);
            }

            // Export to Excel
            static exportToExcel(data, headers, filename) {
                const csv = this.generateCSV(data, headers);
                const excel = '\ufeff' + csv; // UTF-8 BOM for Excel
                const blob = new Blob([excel], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                this.downloadFile(url, filename.replace('.csv', '.xls'));
                URL.revokeObjectURL(url);
            }

            // Print Content
            static printContent(html) {
                const printWindow = window.open('', '_blank');
                printWindow.document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>Print</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 20px; }
                            table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                            th { background-color: #f2f2f2; }
                            .no-print { display: none; }
                        </style>
                    </head>
                    <body>
                        ${html}
                        <script>
                            window.onload = function() {
                                window.print();
                                window.onafterprint = function() {
                                    window.close();
                                };
                            };
                        <\/script>
                    </body>
                    </html>
                `);
                printWindow.document.close();
            }

            // Generate QR Code
            static generateQRCode(text, elementId) {
                if (typeof QRCode !== 'undefined') {
                    new QRCode(document.getElementById(elementId), {
                        text: text,
                        width: 128,
                        height: 128,
                        colorDark: "#000000",
                        colorLight: "#ffffff",
                        correctLevel: QRCode.CorrectLevel.H
                    });
                }
            }
        }

        // ==================== API SERVICE ====================
        class ApiService {
            static async request(endpoint, options = {}) {
                const url = endpoint.startsWith('http') 
                    ? endpoint 
                    : `${CONFIG.BACKEND_URL}${endpoint}`;
                
                const defaultOptions = {
                    headers: {
                        'Authorization': `Bearer ${STATE.token}`,
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    mode: 'cors',
                    credentials: 'include'
                };

                const requestOptions = { ...defaultOptions, ...options };
                
                try {
                    UI.showLoading();
                    const response = await fetch(url, requestOptions);
                    
                    // Handle 401 Unauthorized
                    if (response.status === 401) {
                        localStorage.removeItem('rawWealthyToken');
                        localStorage.removeItem('rawWealthyUser');
                        STATE.token = null;
                        STATE.user = null;
                        showLogin();
                        UI.showToast('Session expired. Please login again.', 'warning');
                        throw new Error('Unauthorized');
                    }

                    // Handle 429 Rate Limit
                    if (response.status === 429) {
                        UI.showToast('Too many requests. Please wait.', 'warning');
                        throw new Error('Rate limited');
                    }

                    const data = await response.json();
                    
                    if (!response.ok) {
                        throw new Error(data.message || `HTTP ${response.status}`);
                    }
                    
                    return data;
                } catch (error) {
                    console.error('API Error:', error);
                    UI.showToast(`API Error: ${error.message}`, 'error');
                    throw error;
                } finally {
                    UI.hideLoading();
                }
            }

            static async get(endpoint, cache = true) {
                const cacheKey = `GET:${endpoint}`;
                
                // Check cache
                if (cache && STATE.dataCache.has(cacheKey)) {
                    const cached = STATE.dataCache.get(cacheKey);
                    if (Date.now() - cached.timestamp < CONFIG.CACHE_TTL) {
                        return cached.data;
                    }
                }
                
                const data = await this.request(endpoint, { method: 'GET' });
                
                // Cache the response
                if (cache && data.success) {
                    STATE.dataCache.set(cacheKey, {
                        data: data.data,
                        timestamp: Date.now()
                    });
                }
                
                return data.data;
            }

            static async post(endpoint, body, options = {}) {
                const requestOptions = {
                    method: 'POST',
                    body: JSON.stringify(body),
                    ...options
                };
                
                // Clear cache for related endpoints
                this.clearCache(endpoint);
                
                const data = await this.request(endpoint, requestOptions);
                return data;
            }

            static async put(endpoint, body, options = {}) {
                const requestOptions = {
                    method: 'PUT',
                    body: JSON.stringify(body),
                    ...options
                };
                
                // Clear cache for related endpoints
                this.clearCache(endpoint);
                
                const data = await this.request(endpoint, requestOptions);
                return data;
            }

            static async delete(endpoint, options = {}) {
                const requestOptions = {
                    method: 'DELETE',
                    ...options
                };
                
                // Clear cache for related endpoints
                this.clearCache(endpoint);
                
                const data = await this.request(endpoint, requestOptions);
                return data;
            }

            static clearCache(pattern = '') {
                for (const key of STATE.dataCache.keys()) {
                    if (key.includes(pattern)) {
                        STATE.dataCache.delete(key);
                    }
                }
            }

            static async uploadFile(file, folder = 'general') {
                const formData = new FormData();
                formData.append('file', file);
                formData.append('folder', folder);
                
                const response = await fetch(`${CONFIG.BACKEND_URL}${CONFIG.ENDPOINTS.UPLOAD}`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${STATE.token}`
                    },
                    body: formData
                });
                
                const data = await response.json();
                return data;
            }
        }

        // ==================== UI COMPONENTS ====================
        class UI {
            // Show/Hide Loading
            static showLoading() {
                STATE.isLoading = true;
                ELEMENTS.loadingOverlay.classList.add('show');
            }

            static hideLoading() {
                STATE.isLoading = false;
                ELEMENTS.loadingOverlay.classList.remove('show');
            }

            // Toast Notifications
            static showToast(message, type = 'info', duration = 5000) {
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                
                const icons = {
                    success: 'fa-check-circle',
                    error: 'fa-exclamation-circle',
                    warning: 'fa-exclamation-triangle',
                    info: 'fa-info-circle'
                };
                
                toast.innerHTML = `
                    <div class="toast-icon">
                        <i class="fas ${icons[type] || 'fa-info-circle'}"></i>
                    </div>
                    <div class="toast-content">
                        <div class="toast-title">${type.charAt(0).toUpperCase() + type.slice(1)}</div>
                        <div class="toast-message">${message}</div>
                    </div>
                    <button class="toast-close" onclick="this.parentElement.remove()">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                ELEMENTS.toastContainer.appendChild(toast);
                
                // Auto remove
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.remove();
                    }
                }, duration);
            }

            // Show Modal
            static showModal(content, options = {}) {
                const modalId = `modal-${Utils.generateId()}`;
                const size = options.size || 'md';
                const title = options.title || '';
                const showFooter = options.showFooter !== false;
                const showClose = options.showClose !== false;
                const onClose = options.onClose;
                
                const modal = document.createElement('div');
                modal.id = modalId;
                modal.className = `modal ${size}`;
                modal.innerHTML = `
                    <div class="modal-dialog">
                        <div class="modal-header">
                            <h3 class="font-semibold">${title}</h3>
                            ${showClose ? '<button class="modal-close" onclick="UI.closeModal(\'' + modalId + '\')"><i class="fas fa-times"></i></button>' : ''}
                        </div>
                        <div class="modal-body">
                            ${content}
                        </div>
                        ${showFooter ? `
                        <div class="modal-footer">
                            ${options.footer || ''}
                        </div>
                        ` : ''}
                    </div>
                `;
                
                document.body.appendChild(modal);
                
                setTimeout(() => {
                    modal.classList.add('open');
                }, 10);
                
                // Close on backdrop click
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        this.closeModal(modalId);
                    }
                });
                
                // Store active modal
                STATE.activeModal = modalId;
                
                return modalId;
            }

            static closeModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.remove('open');
                    setTimeout(() => {
                        modal.remove();
                        if (STATE.activeModal === modalId) {
                            STATE.activeModal = null;
                        }
                    }, 300);
                }
            }

            // Update Page Title
            static updatePageTitle(title) {
                STATE.pageTitle = title;
                ELEMENTS.pageTitle.textContent = title;
                document.title = `${title} - ${CONFIG.APP_NAME}`;
            }

            // Update User Info
            static updateUserInfo(user) {
                if (!user) return;
                
                STATE.user = user;
                localStorage.setItem('rawWealthyUser', JSON.stringify(user));
                
                ELEMENTS.userName.textContent = user.full_name || 'Admin';
                ELEMENTS.userRole.textContent = user.role?.replace('_', ' ').toUpperCase() || 'ADMIN';
                ELEMENTS.userAvatar.textContent = user.full_name?.charAt(0) || 'A';
                ELEMENTS.dropdownUserName.textContent = user.full_name || 'Admin User';
                ELEMENTS.dropdownUserEmail.textContent = user.email || 'admin@rawwealthy.com';
            }

            // Update Badge Counts
            static async updateBadgeCounts() {
                try {
                    const dashboard = await ApiService.get(CONFIG.ENDPOINTS.DASHBOARD_STATS);
                    if (dashboard?.pending_actions) {
                        const badges = {
                            usersBadge: dashboard.total_users || 0,
                            investmentsBadge: dashboard.pending_actions.pending_investments || 0,
                            depositsBadge: dashboard.pending_actions.pending_deposits || 0,
                            withdrawalsBadge: dashboard.pending_actions.pending_withdrawals || 0,
                            kycBadge: dashboard.pending_actions.pending_kyc || 0,
                            supportBadge: 0 // This would need a separate endpoint
                        };
                        
                        for (const [id, count] of Object.entries(badges)) {
                            const badge = document.getElementById(id);
                            if (badge) {
                                badge.textContent = count;
                                badge.style.display = count > 0 ? 'inline-flex' : 'none';
                            }
                        }
                    }
                } catch (error) {
                    console.error('Failed to update badge counts:', error);
                }
            }

            // Update Notifications
            static async updateNotifications() {
                try {
                    const data = await ApiService.get(CONFIG.ENDPOINTS.NOTIFICATIONS + '?limit=5&unread_only=true');
                    const notifications = data?.notifications || [];
                    
                    // Update notification indicator
                    STATE.unreadNotifications = notifications.length;
                    const toggle = ELEMENTS.notifications.querySelector('.notifications-toggle');
                    if (STATE.unreadNotifications > 0) {
                        toggle.classList.add('has-notifications');
                    } else {
                        toggle.classList.remove('has-notifications');
                    }
                    
                    // Update notifications list
                    ELEMENTS.notificationsList.innerHTML = notifications.map(notification => `
                        <div class="notification-item ${notification.is_read ? '' : 'unread'}" 
                             onclick="markNotificationAsRead('${notification._id}')">
                            <div class="flex items-start">
                                <div class="notification-icon ${notification.type}">
                                    <i class="fas ${this.getNotificationIcon(notification.type)}"></i>
                                </div>
                                <div class="notification-content">
                                    <div class="notification-title">${notification.title}</div>
                                    <div class="notification-message">${notification.message}</div>
                                    <div class="notification-time">${Utils.timeAgo(notification.createdAt)}</div>
                                </div>
                            </div>
                        </div>
                    `).join('') || '<div class="notification-item"><div class="notification-content text-center text-gray">No new notifications</div></div>';
                    
                } catch (error) {
                    console.error('Failed to update notifications:', error);
                }
            }

            static getNotificationIcon(type) {
                const icons = {
                    'info': 'fa-info-circle',
                    'success': 'fa-check-circle',
                    'warning': 'fa-exclamation-triangle',
                    'error': 'fa-exclamation-circle',
                    'investment': 'fa-chart-pie',
                    'deposit': 'fa-money-bill-wave',
                    'withdrawal': 'fa-wallet',
                    'kyc': 'fa-id-card',
                    'referral': 'fa-user-friends',
                    'system': 'fa-cog'
                };
                return icons[type] || 'fa-bell';
            }

            // Toggle Sidebar
            static toggleSidebar() {
                STATE.sidebarCollapsed = !STATE.sidebarCollapsed;
                localStorage.setItem('sidebarCollapsed', STATE.sidebarCollapsed);
                
                if (STATE.sidebarCollapsed) {
                    ELEMENTS.sidebar.classList.add('collapsed');
                    ELEMENTS.mainContent.classList.add('expanded');
                    ELEMENTS.toggleSidebar.innerHTML = '<i class="fas fa-chevron-right"></i>';
                } else {
                    ELEMENTS.sidebar.classList.remove('collapsed');
                    ELEMENTS.mainContent.classList.remove('expanded');
                    ELEMENTS.toggleSidebar.innerHTML = '<i class="fas fa-chevron-left"></i>';
                }
            }

            // Toggle Dark Mode
            static toggleDarkMode() {
                STATE.darkMode = !STATE.darkMode;
                localStorage.setItem('darkMode', STATE.darkMode);
                
                if (STATE.darkMode) {
                    document.body.classList.add('dark-mode');
                } else {
                    document.body.classList.remove('dark-mode');
                }
            }

            // Initialize Date Range Picker
            static initDateRangePicker(elementId, callback) {
                const element = document.getElementById(elementId);
                if (element) {
                    $(element).daterangepicker({
                        startDate: moment(STATE.filters.dateRange.start),
                        endDate: moment(STATE.filters.dateRange.end),
                        ranges: {
                            'Today': [moment(), moment()],
                            'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                            'Last 7 Days': [moment().subtract(6, 'days'), moment()],
                            'Last 30 Days': [moment().subtract(29, 'days'), moment()],
                            'This Month': [moment().startOf('month'), moment().endOf('month')],
                            'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
                        },
                        locale: {
                            format: CONFIG.DATE_FORMAT
                        }
                    }, callback);
                }
            }

            // Create Chart
            static createChart(canvasId, config) {
                const canvas = document.getElementById(canvasId);
                if (!canvas) return null;
                
                const ctx = canvas.getContext('2d');
                const chart = new Chart(ctx, config);
                
                // Store chart reference
                STATE.charts.set(canvasId, chart);
                
                return chart;
            }

            // Destroy Chart
            static destroyChart(canvasId) {
                const chart = STATE.charts.get(canvasId);
                if (chart) {
                    chart.destroy();
                    STATE.charts.delete(canvasId);
                }
            }

            // Create Pagination
            static createPagination(currentPage, totalPages, containerId, callback) {
                const container = document.getElementById(containerId);
                if (!container) return;
                
                let html = '<ul class="pagination">';
                
                // Previous button
                html += `
                    <li class="page-item ${currentPage === 1 ? 'disabled' : ''}">
                        <a class="page-link" href="#" onclick="${callback}(${currentPage - 1}); return false;">
                            <i class="fas fa-chevron-left"></i>
                        </a>
                    </li>
                `;
                
                // Page numbers
                const maxVisible = 5;
                let startPage = Math.max(1, currentPage - Math.floor(maxVisible / 2));
                let endPage = Math.min(totalPages, startPage + maxVisible - 1);
                
                if (endPage - startPage + 1 < maxVisible) {
                    startPage = Math.max(1, endPage - maxVisible + 1);
                }
                
                if (startPage > 1) {
                    html += `
                        <li class="page-item">
                            <a class="page-link" href="#" onclick="${callback}(1); return false;">1</a>
                        </li>
                        ${startPage > 2 ? '<li class="page-item disabled"><span class="page-link">...</span></li>' : ''}
                    `;
                }
                
                for (let i = startPage; i <= endPage; i++) {
                    html += `
                        <li class="page-item ${i === currentPage ? 'active' : ''}">
                            <a class="page-link" href="#" onclick="${callback}(${i}); return false;">${i}</a>
                        </li>
                    `;
                }
                
                if (endPage < totalPages) {
                    html += `
                        ${endPage < totalPages - 1 ? '<li class="page-item disabled"><span class="page-link">...</span></li>' : ''}
                        <li class="page-item">
                            <a class="page-link" href="#" onclick="${callback}(${totalPages}); return false;">${totalPages}</a>
                        </li>
                    `;
                }
                
                // Next button
                html += `
                    <li class="page-item ${currentPage === totalPages ? 'disabled' : ''}">
                        <a class="page-link" href="#" onclick="${callback}(${currentPage + 1}); return false;">
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </li>
                `;
                
                html += '</ul>';
                container.innerHTML = html;
            }

            // Create Data Table
            static createDataTable(data, columns, options = {}) {
                const tableId = options.id || `table-${Utils.generateId()}`;
                const showActions = options.showActions !== false;
                const showCheckbox = options.showCheckbox || false;
                const actions = options.actions || [];
                
                let html = `
                    <div class="table-container">
                        <table class="table ${options.compact ? 'table-compact' : ''}" id="${tableId}">
                            <thead>
                                <tr>
                                    ${showCheckbox ? '<th style="width: 40px;"><input type="checkbox" class="form-check-input select-all"></th>' : ''}
                                    ${columns.map(col => `<th>${col.title}</th>`).join('')}
                                    ${showActions ? '<th style="width: 100px;">Actions</th>' : ''}
                                </tr>
                            </thead>
                            <tbody>
                                ${data.map((row, index) => `
                                    <tr>
                                        ${showCheckbox ? `<td><input type="checkbox" class="form-check-input row-select" data-id="${row.id || row._id}"></td>` : ''}
                                        ${columns.map(col => `<td>${col.render ? col.render(row) : row[col.field] || ''}</td>`).join('')}
                                        ${showActions ? `
                                        <td>
                                            <div class="action-buttons">
                                                ${actions.map(action => `
                                                    <button class="btn btn-sm ${action.class || 'btn-outline'}" 
                                                            onclick="${action.onclick}('${row.id || row._id}')"
                                                            ${action.title ? `title="${action.title}"` : ''}>
                                                        <i class="fas ${action.icon}"></i>
                                                    </button>
                                                `).join('')}
                                            </div>
                                        </td>
                                        ` : ''}
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
                
                // Add pagination if needed
                if (options.pagination) {
                    html += `
                        <div class="flex items-center justify-between p-4 border-t">
                            <div class="text-sm text-gray">
                                Showing ${options.pagination.from} to ${options.pagination.to} of ${options.pagination.total} entries
                            </div>
                            <div id="${tableId}-pagination"></div>
                        </div>
                    `;
                }
                
                return html;
            }

            // Create Form
            static createForm(fields, values = {}) {
                let html = '';
                
                for (const field of fields) {
                    const value = values[field.name] || field.default || '';
                    const required = field.required ? 'required' : '';
                    
                    html += `
                        <div class="form-group">
                            <label class="form-label">${field.label}</label>
                    `;
                    
                    switch (field.type) {
                        case 'select':
                            html += `
                                <select id="${field.name}" class="form-select" ${required}>
                                    ${field.options.map(opt => `
                                        <option value="${opt.value}" ${value === opt.value ? 'selected' : ''}>${opt.label}</option>
                                    `).join('')}
                                </select>
                            `;
                            break;
                            
                        case 'textarea':
                            html += `
                                <textarea id="${field.name}" class="form-control" rows="${field.rows || 3}" ${required}>${value}</textarea>
                            `;
                            break;
                            
                        case 'checkbox':
                            html += `
                                <div class="form-check">
                                    <input type="checkbox" id="${field.name}" class="form-check-input" ${value ? 'checked' : ''}>
                                    <label class="form-check-label" for="${field.name}">${field.label}</label>
                                </div>
                            `;
                            break;
                            
                        case 'file':
                            html += `
                                <input type="file" id="${field.name}" class="form-control" ${required} accept="${field.accept || ''}">
                                ${value ? `<div class="mt-2"><a href="${value}" target="_blank">View current file</a></div>` : ''}
                            `;
                            break;
                            
                        case 'date':
                            html += `
                                <input type="date" id="${field.name}" class="form-control" value="${value}" ${required}>
                            `;
                            break;
                            
                        case 'number':
                            html += `
                                <input type="number" id="${field.name}" class="form-control" value="${value}" 
                                       ${field.min ? `min="${field.min}"` : ''} ${field.max ? `max="${field.max}"` : ''} 
                                       ${field.step ? `step="${field.step}"` : ''} ${required}>
                            `;
                            break;
                            
                        default:
                            html += `
                                <input type="${field.type}" id="${field.name}" class="form-control" value="${value}" ${required}>
                            `;
                    }
                    
                    if (field.help) {
                        html += `<div class="form-hint">${field.help}</div>`;
                    }
                    
                    html += '</div>';
                }
                
                return html;
            }
        }

        // ==================== PAGE COMPONENTS ====================
        class Pages {
            // Dashboard
            static async renderDashboard() {
                try {
                    const data = await ApiService.get(CONFIG.ENDPOINTS.DASHBOARD_STATS);
                    
                    const html = `
                        <div class="page-header mb-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h1 class="text-2xl font-bold">Dashboard Overview</h1>
                                    <p class="text-gray">Welcome back, ${STATE.user?.full_name || 'Admin'}! Here's what's happening with your platform.</p>
                                </div>
                                <div class="flex items-center gap-3">
                                    <div class="search-box">
                                        <i class="fas fa-search search-icon"></i>
                                        <input type="text" class="search-input" placeholder="Search dashboard..." onkeyup="filterDashboard(this.value)">
                                    </div>
                                    <button class="btn btn-outline" onclick="refreshDashboard()">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Stats Grid -->
                        <div class="stats-grid mb-6">
                            <div class="stat-card">
                                <div class="stat-icon bg-primary-light text-primary">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-title">Total Users</div>
                                    <div class="stat-value">${data.overview?.total_users?.toLocaleString() || '0'}</div>
                                    <div class="stat-trend ${data.overview?.new_users_today > 0 ? 'up' : 'down'}">
                                        <i class="fas ${data.overview?.new_users_today > 0 ? 'fa-arrow-up' : 'fa-arrow-down'}"></i>
                                        ${data.overview?.new_users_today || '0'} new today
                                    </div>
                                </div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon bg-secondary-light text-secondary">
                                    <i class="fas fa-chart-pie"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-title">Active Investments</div>
                                    <div class="stat-value">${data.overview?.active_investments?.toLocaleString() || '0'}</div>
                                    <div class="stat-trend up">
                                        <i class="fas fa-arrow-up"></i>
                                        ₦${data.overview?.total_investments?.toLocaleString() || '0'} total
                                    </div>
                                </div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon bg-warning-light text-warning">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-title">Pending Actions</div>
                                    <div class="stat-value">${data.pending_actions?.total_pending?.toLocaleString() || '0'}</div>
                                    <div class="stat-trend ${data.pending_actions?.total_pending > 0 ? 'warning' : 'success'}">
                                        <i class="fas fa-exclamation-circle"></i>
                                        Requires attention
                                    </div>
                                </div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon bg-success-light text-success">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-title">Platform Revenue</div>
                                    <div class="stat-value">₦${data.overview?.total_earnings?.toLocaleString() || '0'}</div>
                                    <div class="stat-trend up">
                                        <i class="fas fa-arrow-up"></i>
                                        From all activities
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div class="mb-6">
                            <h2 class="text-xl font-semibold mb-4">Quick Actions</h2>
                            <div class="quick-actions">
                                ${data.pending_actions?.pending_deposits > 0 ? `
                                <a href="#deposits" class="action-card" onclick="navigateTo('deposits')">
                                    <div class="action-icon bg-primary-light text-primary">
                                        <i class="fas fa-money-bill-wave"></i>
                                    </div>
                                    <div class="action-content">
                                        <div class="action-title">Pending Deposits</div>
                                        <div class="action-desc">${data.pending_actions.pending_deposits} deposits awaiting approval</div>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray"></i>
                                </a>
                                ` : ''}
                                
                                ${data.pending_actions?.pending_withdrawals > 0 ? `
                                <a href="#withdrawals" class="action-card" onclick="navigateTo('withdrawals')">
                                    <div class="action-icon bg-warning-light text-warning">
                                        <i class="fas fa-wallet"></i>
                                    </div>
                                    <div class="action-content">
                                        <div class="action-title">Pending Withdrawals</div>
                                        <div class="action-desc">${data.pending_actions.pending_withdrawals} withdrawals to process</div>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray"></i>
                                </a>
                                ` : ''}
                                
                                ${data.pending_actions?.pending_investments > 0 ? `
                                <a href="#investments" class="action-card" onclick="navigateTo('investments')">
                                    <div class="action-icon bg-secondary-light text-secondary">
                                        <i class="fas fa-chart-pie"></i>
                                    </div>
                                    <div class="action-content">
                                        <div class="action-title">Pending Investments</div>
                                        <div class="action-desc">${data.pending_actions.pending_investments} investments to approve</div>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray"></i>
                                </a>
                                ` : ''}
                                
                                ${data.pending_actions?.pending_kyc > 0 ? `
                                <a href="#kyc" class="action-card" onclick="navigateTo('kyc')">
                                    <div class="action-icon bg-info-light text-info">
                                        <i class="fas fa-id-card"></i>
                                    </div>
                                    <div class="action-content">
                                        <div class="action-title">Pending KYC</div>
                                        <div class="action-desc">${data.pending_actions.pending_kyc} verifications pending</div>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray"></i>
                                </a>
                                ` : ''}
                            </div>
                        </div>
                        
                        <!-- Charts -->
                        <div class="charts-grid mb-6">
                            <div class="chart-card">
                                <div class="chart-header">
                                    <h3 class="font-semibold">Revenue Overview</h3>
                                </div>
                                <div class="chart-body">
                                    <canvas id="revenueChart"></canvas>
                                </div>
                            </div>
                            
                            <div class="chart-card">
                                <div class="chart-header">
                                    <h3 class="font-semibold">User Growth</h3>
                                </div>
                                <div class="chart-body">
                                    <canvas id="userGrowthChart"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Recent Activity -->
                        <div class="card">
                            <div class="card-header">
                                <h3 class="font-semibold">Recent Activity</h3>
                            </div>
                            <div class="card-body">
                                <div id="recentActivity" class="activity-feed">
                                    <!-- Activity items will be loaded here -->
                                </div>
                            </div>
                        </div>
                    `;
                    
                    ELEMENTS.pageContent.innerHTML = html;
                    
                    // Initialize charts
                    this.initDashboardCharts(data);
                    
                    // Load recent activity
                    this.loadRecentActivity();
                    
                } catch (error) {
                    ELEMENTS.pageContent.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <h3 class="empty-state-title">Error Loading Dashboard</h3>
                            <p class="empty-state-description">Failed to load dashboard data. Please try again.</p>
                            <button class="btn btn-primary" onclick="navigateTo('dashboard')">
                                <i class="fas fa-sync-alt"></i> Retry
                            </button>
                        </div>
                    `;
                }
            }

            static initDashboardCharts(data) {
                // Revenue Chart
                UI.createChart('revenueChart', {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
                        datasets: [{
                            label: 'Revenue',
                            data: [12000, 19000, 15000, 25000, 22000, 30000, 28000],
                            borderColor: 'rgb(102, 126, 234)',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    drawBorder: false
                                },
                                ticks: {
                                    callback: function(value) {
                                        return '₦' + value.toLocaleString();
                                    }
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });

                // User Growth Chart
                UI.createChart('userGrowthChart', {
                    type: 'bar',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
                        datasets: [{
                            label: 'New Users',
                            data: [45, 60, 75, 90, 120, 150, 180],
                            backgroundColor: 'rgba(16, 185, 129, 0.8)',
                            borderColor: 'rgb(16, 185, 129)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    drawBorder: false
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }

            static async loadRecentActivity() {
                try {
                    const data = await ApiService.get(CONFIG.ENDPOINTS.TRANSACTIONS + '?limit=10');
                    const container = document.getElementById('recentActivity');
                    
                    if (container && data?.transactions) {
                        container.innerHTML = data.transactions.map(transaction => `
                            <div class="activity-item">
                                <div class="activity-icon ${transaction.type}">
                                    <i class="fas ${this.getTransactionIcon(transaction.type)}"></i>
                                </div>
                                <div class="activity-content">
                                    <div class="activity-title">${transaction.description}</div>
                                    <div class="activity-desc">
                                        ${Utils.formatCurrency(transaction.amount)} • ${transaction.user?.full_name || 'User'}
                                    </div>
                                    <div class="activity-time">${Utils.timeAgo(transaction.createdAt)}</div>
                                </div>
                            </div>
                        `).join('');
                    }
                } catch (error) {
                    console.error('Failed to load recent activity:', error);
                }
            }

            static getTransactionIcon(type) {
                const icons = {
                    'deposit': 'fa-money-bill-wave',
                    'withdrawal': 'fa-wallet',
                    'investment': 'fa-chart-pie',
                    'earning': 'fa-coins',
                    'referral': 'fa-user-friends',
                    'bonus': 'fa-gift',
                    'fee': 'fa-file-invoice-dollar',
                    'refund': 'fa-undo',
                    'transfer': 'fa-exchange-alt'
                };
                return icons[type] || 'fa-exchange-alt';
            }

            // Users Page
            static async renderUsers(page = 1) {
                try {
                    const query = new URLSearchParams({
                        page: page,
                        limit: CONFIG.ITEMS_PER_PAGE,
                        ...STATE.filters
                    }).toString();
                    
                    const data = await ApiService.get(`${CONFIG.ENDPOINTS.USERS}?${query}`);
                    
                    const html = `
                        <div class="page-header mb-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h1 class="text-2xl font-bold">Users Management</h1>
                                    <p class="text-gray">Manage all users, their accounts, and permissions</p>
                                </div>
                                <div class="flex items-center gap-3">
                                    <button class="btn btn-primary" onclick="showCreateUserModal()">
                                        <i class="fas fa-plus"></i> Add User
                                    </button>
                                    <button class="btn btn-outline" onclick="exportUsers()">
                                        <i class="fas fa-download"></i> Export
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Filter Bar -->
                        <div class="filter-bar mb-6">
                            <div class="flex-1">
                                <input type="text" class="form-control" placeholder="Search users..." 
                                       value="${STATE.filters.search || ''}" 
                                       onkeyup="Utils.debounce(filterUsers, 300)(this.value)">
                            </div>
                            <select class="form-control" style="width: 150px;" onchange="filterUsersByStatus(this.value)">
                                <option value="">All Status</option>
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                            </select>
                            <select class="form-control" style="width: 150px;" onchange="filterUsersByRole(this.value)">
                                <option value="">All Roles</option>
                                <option value="user">User</option>
                                <option value="admin">Admin</option>
                                <option value="super_admin">Super Admin</option>
                            </select>
                            <input type="text" id="userDateRange" class="form-control" style="width: 200px;" placeholder="Date Range">
                        </div>
                        
                        <!-- Users Table -->
                        ${UI.createDataTable(data.users || [], [
                            {
                                field: 'full_name',
                                title: 'Name',
                                render: (user) => `
                                    <div class="flex items-center gap-3">
                                        <div class="user-avatar">${user.full_name?.charAt(0) || 'U'}</div>
                                        <div>
                                            <div class="font-semibold">${user.full_name || 'N/A'}</div>
                                            <div class="text-xs text-gray">${user.email || ''}</div>
                                        </div>
                                    </div>
                                `
                            },
                            {
                                field: 'phone',
                                title: 'Phone',
                                render: (user) => user.phone || 'N/A'
                            },
                            {
                                field: 'balance',
                                title: 'Balance',
                                render: (user) => Utils.formatCurrency(user.balance || 0)
                            },
                            {
                                field: 'role',
                                title: 'Role',
                                render: (user) => `
                                    <span class="badge ${user.role === 'super_admin' ? 'badge-primary' : user.role === 'admin' ? 'badge-secondary' : 'badge-gray'}">
                                        ${user.role?.replace('_', ' ').toUpperCase() || 'USER'}
                                    </span>
                                `
                            },
                            {
                                field: 'status',
                                title: 'Status',
                                render: (user) => `
                                    <div class="status-indicator">
                                        <span class="status-dot status-dot-${Utils.getStatusColor(user.is_active ? 'active' : 'inactive')}"></span>
                                        <span>${user.is_active ? 'Active' : 'Inactive'}</span>
                                    </div>
                                `
                            },
                            {
                                field: 'kyc',
                                title: 'KYC',
                                render: (user) => `
                                    <span class="badge badge-${Utils.getStatusColor(user.kyc_status)}">
                                        ${user.kyc_status?.toUpperCase() || 'NOT SUBMITTED'}
                                    </span>
                                `
                            },
                            {
                                field: 'createdAt',
                                title: 'Joined',
                                render: (user) => Utils.formatDate(user.createdAt)
                            }
                        ], {
                            id: 'usersTable',
                            showActions: true,
                            actions: [
                                {
                                    icon: 'fa-eye',
                                    class: 'btn-outline',
                                    title: 'View Details',
                                    onclick: 'viewUser'
                                },
                                {
                                    icon: 'fa-edit',
                                    class: 'btn-outline',
                                    title: 'Edit User',
                                    onclick: 'editUser'
                                },
                                {
                                    icon: 'fa-power-off',
                                    class: 'btn-outline',
                                    title: 'Toggle Status',
                                    onclick: 'toggleUserStatus'
                                }
                            ]
                        })}
                        
                        <!-- Pagination -->
                        ${data.pagination ? `
                        <div class="mt-6">
                            ${UI.createPagination(
                                data.pagination.page,
                                data.pagination.pages,
                                'usersPagination',
                                'loadUsersPage'
                            )}
                        </div>
                        ` : ''}
                    `;
                    
                    ELEMENTS.pageContent.innerHTML = html;
                    
                    // Initialize date range picker
                    UI.initDateRangePicker('userDateRange', (start, end) => {
                        STATE.filters.dateRange = {
                            start: start.format(CONFIG.DATE_FORMAT),
                            end: end.format(CONFIG.DATE_FORMAT)
                        };
                        Pages.renderUsers(1);
                    });
                    
                } catch (error) {
                    ELEMENTS.pageContent.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <h3 class="empty-state-title">No Users Found</h3>
                            <p class="empty-state-description">There are no users to display at the moment.</p>
                            <button class="btn btn-primary" onclick="Pages.renderUsers()">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>
                    `;
                }
            }

            // Investments Page
            static async renderInvestments(page = 1) {
                try {
                    const query = new URLSearchParams({
                        page: page,
                        limit: CONFIG.ITEMS_PER_PAGE,
                        status: 'pending',
                        ...STATE.filters
                    }).toString();
                    
                    const data = await ApiService.get(`${CONFIG.ENDPOINTS.PENDING_INVESTMENTS}?${query}`);
                    
                    const html = `
                        <div class="page-header mb-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h1 class="text-2xl font-bold">Pending Investments</h1>
                                    <p class="text-gray">Review and approve investment requests</p>
                                </div>
                                <div class="flex items-center gap-3">
                                    <button class="btn btn-outline" onclick="refreshInvestments()">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Stats Overview -->
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                            <div class="card">
                                <div class="card-body">
                                    <div class="text-sm text-gray mb-1">Pending Investments</div>
                                    <div class="text-2xl font-bold">${data.count || 0}</div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-body">
                                    <div class="text-sm text-gray mb-1">Total Amount</div>
                                    <div class="text-2xl font-bold">${Utils.formatCurrency(data.total_amount || 0)}</div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-body">
                                    <div class="text-sm text-gray mb-1">Avg. Investment</div>
                                    <div class="text-2xl font-bold">${Utils.formatCurrency(data.total_amount / (data.count || 1))}</div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-body">
                                    <div class="text-sm text-gray mb-1">Today's Approvals</div>
                                    <div class="text-2xl font-bold">0</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Investments Table -->
                        ${data.investments && data.investments.length > 0 ? `
                        <div class="table-container">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>User</th>
                                        <th>Plan</th>
                                        <th>Amount</th>
                                        <th>Expected Earnings</th>
                                        <th>Status</th>
                                        <th>Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${data.investments.map(inv => `
                                        <tr>
                                            <td>
                                                <div class="flex items-center gap-3">
                                                    <div class="user-avatar">${inv.user?.full_name?.charAt(0) || 'U'}</div>
                                                    <div>
                                                        <div class="font-semibold">${inv.user?.full_name || 'N/A'}</div>
                                                        <div class="text-xs text-gray">${inv.user?.email || ''}</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="font-semibold">${inv.plan?.name || 'N/A'}</div>
                                                <div class="text-xs text-gray">${inv.plan?.daily_interest || '0'}% daily</div>
                                            </td>
                                            <td class="font-semibold">${Utils.formatCurrency(inv.amount || 0)}</td>
                                            <td>
                                                <div class="font-semibold">${Utils.formatCurrency(inv.expected_earnings || 0)}</div>
                                                <div class="text-xs text-gray">Total interest</div>
                                            </td>
                                            <td>
                                                <span class="badge badge-warning">${inv.status?.toUpperCase() || 'PENDING'}</span>
                                            </td>
                                            <td>
                                                <div class="text-sm">${Utils.formatDate(inv.createdAt)}</div>
                                                <div class="text-xs text-gray">${Utils.timeAgo(inv.createdAt)}</div>
                                            </td>
                                            <td>
                                                <div class="action-buttons">
                                                    <button class="btn btn-sm btn-success" onclick="approveInvestment('${inv._id}')">
                                                        <i class="fas fa-check"></i> Approve
                                                    </button>
                                                    <button class="btn btn-sm btn-outline" onclick="viewInvestment('${inv._id}')">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-danger" onclick="rejectInvestment('${inv._id}')">
                                                        <i class="fas fa-times"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        ` : `
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <i class="fas fa-chart-pie"></i>
                            </div>
                            <h3 class="empty-state-title">No Pending Investments</h3>
                            <p class="empty-state-description">All investments have been processed.</p>
                        </div>
                        `}
                    `;
                    
                    ELEMENTS.pageContent.innerHTML = html;
                    
                } catch (error) {
                    ELEMENTS.pageContent.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <h3 class="empty-state-title">Error Loading Investments</h3>
                            <p class="empty-state-description">Failed to load investment data. Please try again.</p>
                            <button class="btn btn-primary" onclick="Pages.renderInvestments()">
                                <i class="fas fa-sync-alt"></i> Retry
                            </button>
                        </div>
                    `;
                }
            }

            // Deposits Page
            static async renderDeposits(page = 1) {
                try {
                    const query = new URLSearchParams({
                        page: page,
                        limit: CONFIG.ITEMS_PER_PAGE,
                        status: 'pending',
                        ...STATE.filters
                    }).toString();
                    
                    const data = await ApiService.get(`${CONFIG.ENDPOINTS.PENDING_DEPOSITS}?${query}`);
                    
                    const html = `
                        <div class="page-header mb-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h1 class="text-2xl font-bold">Pending Deposits</h1>
                                    <p class="text-gray">Review and approve deposit requests</p>
                                </div>
                                <div class="flex items-center gap-3">
                                    <button class="btn btn-outline" onclick="refreshDeposits()">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Deposits Table -->
                        ${data.deposits && data.deposits.length > 0 ? `
                        <div class="table-container">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>User</th>
                                        <th>Amount</th>
                                        <th>Method</th>
                                        <th>Reference</th>
                                        <th>Proof</th>
                                        <th>Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${data.deposits.map(dep => `
                                        <tr>
                                            <td>
                                                <div class="flex items-center gap-3">
                                                    <div class="user-avatar">${dep.user?.full_name?.charAt(0) || 'U'}</div>
                                                    <div>
                                                        <div class="font-semibold">${dep.user?.full_name || 'N/A'}</div>
                                                        <div class="text-xs text-gray">${dep.user?.email || ''}</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="font-semibold">${Utils.formatCurrency(dep.amount || 0)}</td>
                                            <td>
                                                <span class="badge badge-info">${dep.payment_method?.replace('_', ' ').toUpperCase() || 'N/A'}</span>
                                            </td>
                                            <td>
                                                <code class="text-xs">${dep.reference || 'N/A'}</code>
                                            </td>
                                            <td>
                                                ${dep.payment_proof_url ? `
                                                <button class="btn btn-sm btn-outline" onclick="viewProof('${dep.payment_proof_url}')">
                                                    <i class="fas fa-eye"></i> View
                                                </button>
                                                ` : 'No proof'}
                                            </td>
                                            <td>
                                                <div class="text-sm">${Utils.formatDate(dep.createdAt)}</div>
                                                <div class="text-xs text-gray">${Utils.timeAgo(dep.createdAt)}</div>
                                            </td>
                                            <td>
                                                <div class="action-buttons">
                                                    <button class="btn btn-sm btn-success" onclick="approveDeposit('${dep._id}')">
                                                        <i class="fas fa-check"></i> Approve
                                                    </button>
                                                    <button class="btn btn-sm btn-outline" onclick="viewDeposit('${dep._id}')">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-danger" onclick="rejectDeposit('${dep._id}')">
                                                        <i class="fas fa-times"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Summary -->
                        <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="card">
                                <div class="card-body text-center">
                                    <div class="text-2xl font-bold text-success">${Utils.formatCurrency(data.total_amount || 0)}</div>
                                    <div class="text-sm text-gray">Total Pending</div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-body text-center">
                                    <div class="text-2xl font-bold">${data.count || 0}</div>
                                    <div class="text-sm text-gray">Total Requests</div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-body text-center">
                                    <div class="text-2xl font-bold">0</div>
                                    <div class="text-sm text-gray">Processed Today</div>
                                </div>
                            </div>
                        </div>
                        ` : `
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <h3 class="empty-state-title">No Pending Deposits</h3>
                            <p class="empty-state-description">All deposits have been processed.</p>
                        </div>
                        `}
                    `;
                    
                    ELEMENTS.pageContent.innerHTML = html;
                    
                } catch (error) {
                    ELEMENTS.pageContent.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <h3 class="empty-state-title">Error Loading Deposits</h3>
                            <p class="empty-state-description">Failed to load deposit data. Please try again.</p>
                            <button class="btn btn-primary" onclick="Pages.renderDeposits()">
                                <i class="fas fa-sync-alt"></i> Retry
                            </button>
                        </div>
                    `;
                }
            }

            // Withdrawals Page
            static async renderWithdrawals(page = 1) {
                try {
                    const query = new URLSearchParams({
                        page: page,
                        limit: CONFIG.ITEMS_PER_PAGE,
                        status: 'pending',
                        ...STATE.filters
                    }).toString();
                    
                    const data = await ApiService.get(`${CONFIG.ENDPOINTS.PENDING_WITHDRAWALS}?${query}`);
                    
                    const html = `
                        <div class="page-header mb-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h1 class="text-2xl font-bold">Pending Withdrawals</h1>
                                    <p class="text-gray">Review and approve withdrawal requests</p>
                                </div>
                                <div class="flex items-center gap-3">
                                    <button class="btn btn-outline" onclick="refreshWithdrawals()">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Withdrawals Table -->
                        ${data.withdrawals && data.withdrawals.length > 0 ? `
                        <div class="table-container">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>User</th>
                                        <th>Amount</th>
                                        <th>Net Amount</th>
                                        <th>Method</th>
                                        <th>Reference</th>
                                        <th>Status</th>
                                        <th>Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${data.withdrawals.map(wd => `
                                        <tr>
                                            <td>
                                                <div class="flex items-center gap-3">
                                                    <div class="user-avatar">${wd.user?.full_name?.charAt(0) || 'U'}</div>
                                                    <div>
                                                        <div class="font-semibold">${wd.user?.full_name || 'N/A'}</div>
                                                        <div class="text-xs text-gray">${wd.user?.email || ''}</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="font-semibold">${Utils.formatCurrency(wd.amount || 0)}</td>
                                            <td>
                                                <div class="font-semibold">${Utils.formatCurrency(wd.net_amount || 0)}</div>
                                                <div class="text-xs text-gray">Fee: ${Utils.formatCurrency(wd.platform_fee || 0)}</div>
                                            </td>
                                            <td>
                                                <span class="badge badge-info">${wd.payment_method?.replace('_', ' ').toUpperCase() || 'N/A'}</span>
                                            </td>
                                            <td>
                                                <code class="text-xs">${wd.reference || 'N/A'}</code>
                                            </td>
                                            <td>
                                                <span class="badge badge-warning">${wd.status?.toUpperCase() || 'PENDING'}</span>
                                            </td>
                                            <td>
                                                <div class="text-sm">${Utils.formatDate(wd.createdAt)}</div>
                                                <div class="text-xs text-gray">${Utils.timeAgo(wd.createdAt)}</div>
                                            </td>
                                            <td>
                                                <div class="action-buttons">
                                                    <button class="btn btn-sm btn-success" onclick="approveWithdrawal('${wd._id}')">
                                                        <i class="fas fa-check"></i> Approve
                                                    </button>
                                                    <button class="btn btn-sm btn-outline" onclick="viewWithdrawal('${wd._id}')">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-danger" onclick="rejectWithdrawal('${wd._id}')">
                                                        <i class="fas fa-times"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Summary -->
                        <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="card">
                                <div class="card-body text-center">
                                    <div class="text-2xl font-bold text-danger">${Utils.formatCurrency(data.total_amount || 0)}</div>
                                    <div class="text-sm text-gray">Total Pending</div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-body text-center">
                                    <div class="text-2xl font-bold">${data.count || 0}</div>
                                    <div class="text-sm text-gray">Total Requests</div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-body text-center">
                                    <div class="text-2xl font-bold">${Utils.formatCurrency((data.total_amount || 0) * 0.1)}</div>
                                    <div class="text-sm text-gray">Total Fees</div>
                                </div>
                            </div>
                        </div>
                        ` : `
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <i class="fas fa-wallet"></i>
                            </div>
                            <h3 class="empty-state-title">No Pending Withdrawals</h3>
                            <p class="empty-state-description">All withdrawals have been processed.</p>
                        </div>
                        `}
                    `;
                    
                    ELEMENTS.pageContent.innerHTML = html;
                    
                } catch (error) {
                    ELEMENTS.pageContent.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <h3 class="empty-state-title">Error Loading Withdrawals</h3>
                            <p class="empty-state-description">Failed to load withdrawal data. Please try again.</p>
                            <button class="btn btn-primary" onclick="Pages.renderWithdrawals()">
                                <i class="fas fa-sync-alt"></i> Retry
                            </button>
                        </div>
                    `;
                }
            }

            // KYC Page
            static async renderKYC(page = 1) {
                try {
                    const data = await ApiService.get(CONFIG.ENDPOINTS.KYC_SUBMISSIONS);
                    
                    const html = `
                        <div class="page-header mb-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h1 class="text-2xl font-bold">KYC Verification</h1>
                                    <p class="text-gray">Review and verify user identity documents</p>
                                </div>
                                <div class="flex items-center gap-3">
                                    <button class="btn btn-outline" onclick="refreshKYC()">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- KYC Submissions -->
                        ${data.kyc_submissions && data.kyc_submissions.length > 0 ? `
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            ${data.kyc_submissions.map(kyc => `
                                <div class="card">
                                    <div class="card-body">
                                        <div class="flex items-center justify-between mb-4">
                                            <div class="flex items-center gap-3">
                                                <div class="user-avatar">${kyc.user?.full_name?.charAt(0) || 'U'}</div>
                                                <div>
                                                    <div class="font-semibold">${kyc.user?.full_name || 'N/A'}</div>
                                                    <div class="text-xs text-gray">${kyc.user?.email || ''}</div>
                                                </div>
                                            </div>
                                            <span class="badge badge-warning">${kyc.status?.toUpperCase() || 'PENDING'}</span>
                                        </div>
                                        
                                        <div class="space-y-3 mb-4">
                                            <div>
                                                <div class="text-xs text-gray mb-1">ID Type</div>
                                                <div class="font-medium">${kyc.id_type?.replace('_', ' ').toUpperCase() || 'N/A'}</div>
                                            </div>
                                            <div>
                                                <div class="text-xs text-gray mb-1">ID Number</div>
                                                <div class="font-medium">${kyc.id_number || 'N/A'}</div>
                                            </div>
                                            <div>
                                                <div class="text-xs text-gray mb-1">Submitted</div>
                                                <div class="font-medium">${Utils.timeAgo(kyc.createdAt)}</div>
                                            </div>
                                        </div>
                                        
                                        <div class="grid grid-cols-2 gap-2 mb-4">
                                            ${kyc.id_front_url ? `
                                            <button class="btn btn-sm btn-outline" onclick="viewDocument('${kyc.id_front_url}')">
                                                <i class="fas fa-id-card"></i> Front
                                            </button>
                                            ` : ''}
                                            ${kyc.id_back_url ? `
                                            <button class="btn btn-sm btn-outline" onclick="viewDocument('${kyc.id_back_url}')">
                                                <i class="fas fa-id-card"></i> Back
                                            </button>
                                            ` : ''}
                                            ${kyc.selfie_with_id_url ? `
                                            <button class="btn btn-sm btn-outline" onclick="viewDocument('${kyc.selfie_with_id_url}')">
                                                <i class="fas fa-user"></i> Selfie
                                            </button>
                                            ` : ''}
                                            ${kyc.address_proof_url ? `
                                            <button class="btn btn-sm btn-outline" onclick="viewDocument('${kyc.address_proof_url}')">
                                                <i class="fas fa-home"></i> Address
                                            </button>
                                            ` : ''}
                                        </div>
                                        
                                        <div class="action-buttons">
                                            <button class="btn btn-sm btn-success" onclick="approveKYC('${kyc._id}')">
                                                <i class="fas fa-check"></i> Approve
                                            </button>
                                            <button class="btn btn-sm btn-outline" onclick="viewKYCDetails('${kyc._id}')">
                                                <i class="fas fa-eye"></i> View
                                            </button>
                                            <button class="btn btn-sm btn-danger" onclick="rejectKYC('${kyc._id}')">
                                                <i class="fas fa-times"></i> Reject
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <!-- Summary -->
                        <div class="mt-6 grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div class="card">
                                <div class="card-body text-center">
                                    <div class="text-2xl font-bold">${data.count || 0}</div>
                                    <div class="text-sm text-gray">Pending KYC</div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-body text-center">
                                    <div class="text-2xl font-bold">0</div>
                                    <div class="text-sm text-gray">Verified Today</div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-body text-center">
                                    <div class="text-2xl font-bold">0</div>
                                    <div class="text-sm text-gray">Rejected Today</div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-body text-center">
                                    <div class="text-2xl font-bold">${data.count || 0}</div>
                                    <div class="text-sm text-gray">Total Pending</div>
                                </div>
                            </div>
                        </div>
                        ` : `
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <i class="fas fa-id-card"></i>
                            </div>
                            <h3 class="empty-state-title">No Pending KYC</h3>
                            <p class="empty-state-description">All KYC submissions have been processed.</p>
                        </div>
                        `}
                    `;
                    
                    ELEMENTS.pageContent.innerHTML = html;
                    
                } catch (error) {
                    ELEMENTS.pageContent.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <h3 class="empty-state-title">Error Loading KYC</h3>
                            <p class="empty-state-description">Failed to load KYC data. Please try again.</p>
                            <button class="btn btn-primary" onclick="Pages.renderKYC()">
                                <i class="fas fa-sync-alt"></i> Retry
                            </button>
                        </div>
                    `;
                }
            }

            // Settings Page
            static async renderSettings() {
                const html = `
                    <div class="page-header mb-6">
                        <h1 class="text-2xl font-bold">System Settings</h1>
                        <p class="text-gray">Configure platform settings and preferences</p>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Left Column -->
                        <div class="lg:col-span-2">
                            <div class="card mb-6">
                                <div class="card-header">
                                    <h3 class="font-semibold">General Settings</h3>
                                </div>
                                <div class="card-body">
                                    <form id="generalSettingsForm">
                                        <div class="form-group">
                                            <label class="form-label">Platform Name</label>
                                            <input type="text" class="form-control" value="Raw Wealthy">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Platform URL</label>
                                            <input type="text" class="form-control" value="https://rawwealthy.com">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Support Email</label>
                                            <input type="email" class="form-control" value="support@rawwealthy.com">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Currency</label>
                                            <select class="form-select">
                                                <option value="NGN" selected>Nigerian Naira (₦)</option>
                                                <option value="USD">US Dollar ($)</option>
                                                <option value="EUR">Euro (€)</option>
                                                <option value="GBP">British Pound (£)</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Timezone</label>
                                            <select class="form-select">
                                                <option value="Africa/Lagos" selected>Africa/Lagos (WAT)</option>
                                                <option value="UTC">UTC</option>
                                                <option value="America/New_York">America/New York (EST)</option>
                                                <option value="Europe/London">Europe/London (GMT)</option>
                                            </select>
                                        </div>
                                        <button type="submit" class="btn btn-primary">Save Changes</button>
                                    </form>
                                </div>
                            </div>
                            
                            <div class="card mb-6">
                                <div class="card-header">
                                    <h3 class="font-semibold">Financial Settings</h3>
                                </div>
                                <div class="card-body">
                                    <form id="financialSettingsForm">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                            <div class="form-group">
                                                <label class="form-label">Minimum Investment (₦)</label>
                                                <input type="number" class="form-control" value="3500" min="0">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Minimum Deposit (₦)</label>
                                                <input type="number" class="form-control" value="3500" min="0">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Minimum Withdrawal (₦)</label>
                                                <input type="number" class="form-control" value="3500" min="0">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Withdrawal Fee (%)</label>
                                                <input type="number" class="form-control" value="10" min="0" max="100" step="0.1">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Referral Commission (%)</label>
                                                <input type="number" class="form-control" value="10" min="0" max="100" step="0.1">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Welcome Bonus (₦)</label>
                                                <input type="number" class="form-control" value="100" min="0">
                                            </div>
                                        </div>
                                        <button type="submit" class="btn btn-primary">Save Changes</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Right Column -->
                        <div>
                            <div class="card mb-6">
                                <div class="card-header">
                                    <h3 class="font-semibold">System Information</h3>
                                </div>
                                <div class="card-body">
                                    <div class="space-y-3">
                                        <div>
                                            <div class="text-xs text-gray mb-1">Backend Version</div>
                                            <div class="font-medium">v38.0.0</div>
                                        </div>
                                        <div>
                                            <div class="text-xs text-gray mb-1">Frontend Version</div>
                                            <div class="font-medium">v4.0.0</div>
                                        </div>
                                        <div>
                                            <div class="text-xs text-gray mb-1">Database</div>
                                            <div class="font-medium">MongoDB</div>
                                        </div>
                                        <div>
                                            <div class="text-xs text-gray mb-1">Server URL</div>
                                            <div class="font-medium">${CONFIG.BACKEND_URL}</div>
                                        </div>
                                        <div>
                                            <div class="text-xs text-gray mb-1">Last Updated</div>
                                            <div class="font-medium">${new Date().toLocaleDateString()}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card mb-6">
                                <div class="card-header">
                                    <h3 class="font-semibold">Quick Actions</h3>
                                </div>
                                <div class="card-body">
                                    <div class="space-y-2">
                                        <button class="btn btn-outline w-full justify-start" onclick="clearCache()">
                                            <i class="fas fa-broom mr-2"></i> Clear Cache
                                        </button>
                                        <button class="btn btn-outline w-full justify-start" onclick="refreshAllData()">
                                            <i class="fas fa-sync-alt mr-2"></i> Refresh All Data
                                        </button>
                                        <button class="btn btn-outline w-full justify-start" onclick="backupDatabase()">
                                            <i class="fas fa-database mr-2"></i> Backup Database
                                        </button>
                                        <button class="btn btn-outline w-full justify-start" onclick="showApiKeys()">
                                            <i class="fas fa-key mr-2"></i> API Keys
                                        </button>
                                        <button class="btn btn-outline w-full justify-start" onclick="showSystemLogs()">
                                            <i class="fas fa-file-alt mr-2"></i> System Logs
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="font-semibold">Danger Zone</h3>
                                </div>
                                <div class="card-body">
                                    <div class="space-y-2">
                                        <button class="btn btn-danger w-full" onclick="maintenanceMode()">
                                            <i class="fas fa-tools mr-2"></i> Maintenance Mode
                                        </button>
                                        <button class="btn btn-danger w-full" onclick="clearAllData()">
                                            <i class="fas fa-trash mr-2"></i> Clear All Data
                                        </button>
                                        <button class="btn btn-danger w-full" onclick="resetSystem()">
                                            <i class="fas fa-redo mr-2"></i> Reset System
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                ELEMENTS.pageContent.innerHTML = html;
                
                // Initialize form handlers
                document.getElementById('generalSettingsForm')?.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    UI.showToast('Settings saved successfully', 'success');
                });
                
                document.getElementById('financialSettingsForm')?.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    UI.showToast('Financial settings saved', 'success');
                });
            }

            // Analytics Page
            static async renderAnalytics() {
                const html = `
                    <div class="page-header mb-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <h1 class="text-2xl font-bold">Advanced Analytics</h1>
                                <p class="text-gray">Detailed insights and performance metrics</p>
                            </div>
                            <div class="flex items-center gap-3">
                                <select class="form-control" onchange="changeAnalyticsPeriod(this.value)">
                                    <option value="7d">Last 7 Days</option>
                                    <option value="30d" selected>Last 30 Days</option>
                                    <option value="90d">Last 90 Days</option>
                                    <option value="1y">Last Year</option>
                                </select>
                                <button class="btn btn-outline" onclick="exportAnalytics()">
                                    <i class="fas fa-download"></i> Export
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Summary Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                        <div class="card">
                            <div class="card-body">
                                <div class="text-sm text-gray mb-1">Total Revenue</div>
                                <div class="text-2xl font-bold text-success">₦2,458,900</div>
                                <div class="text-xs text-success">
                                    <i class="fas fa-arrow-up"></i> 12.5% from last period
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-body">
                                <div class="text-sm text-gray mb-1">Active Users</div>
                                <div class="text-2xl font-bold">1,245</div>
                                <div class="text-xs text-success">
                                    <i class="fas fa-arrow-up"></i> 8.2% from last period
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-body">
                                <div class="text-sm text-gray mb-1">Total Investments</div>
                                <div class="text-2xl font-bold">₦15,789,000</div>
                                <div class="text-xs text-success">
                                    <i class="fas fa-arrow-up"></i> 15.3% from last period
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-body">
                                <div class="text-sm text-gray mb-1">Avg. Investment</div>
                                <div class="text-2xl font-bold">₦12,680</div>
                                <div class="text-xs text-danger">
                                    <i class="fas fa-arrow-down"></i> 2.1% from last period
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Charts -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3 class="font-semibold">Revenue Breakdown</h3>
                            </div>
                            <div class="chart-body">
                                <canvas id="revenueBreakdownChart"></canvas>
                            </div>
                        </div>
                        
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3 class="font-semibold">User Growth Trend</h3>
                            </div>
                            <div class="chart-body">
                                <canvas id="userTrendChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Detailed Analytics -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="font-semibold">Detailed Metrics</h3>
                        </div>
                        <div class="card-body">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div>
                                    <h4 class="font-semibold mb-4">Investment Plans</h4>
                                    <div id="planMetrics">
                                        <!-- Plan metrics will be loaded here -->
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-semibold mb-4">User Demographics</h4>
                                    <div id="demographicMetrics">
                                        <!-- Demographic metrics will be loaded here -->
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-semibold mb-4">Platform Performance</h4>
                                    <div id="performanceMetrics">
                                        <!-- Performance metrics will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                ELEMENTS.pageContent.innerHTML = html;
                
                // Initialize charts
                this.initAnalyticsCharts();
            }

            static initAnalyticsCharts() {
                // Revenue Breakdown Chart
                UI.createChart('revenueBreakdownChart', {
                    type: 'doughnut',
                    data: {
                        labels: ['Investments', 'Fees', 'Commissions', 'Other'],
                        datasets: [{
                            data: [65, 15, 15, 5],
                            backgroundColor: [
                                'rgb(102, 126, 234)',
                                'rgb(16, 185, 129)',
                                'rgb(245, 158, 11)',
                                'rgb(156, 163, 175)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });

                // User Trend Chart
                UI.createChart('userTrendChart', {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
                        datasets: [
                            {
                                label: 'New Users',
                                data: [120, 150, 180, 210, 240, 280, 320],
                                borderColor: 'rgb(102, 126, 234)',
                                backgroundColor: 'rgba(102, 126, 234, 0.1)',
                                borderWidth: 2,
                                fill: true
                            },
                            {
                                label: 'Active Users',
                                data: [100, 130, 160, 190, 220, 250, 290],
                                borderColor: 'rgb(16, 185, 129)',
                                backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                borderWidth: 2,
                                fill: true
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        }

        // ==================== EVENT HANDLERS ====================
        // Login
        async function handleLogin(e) {
            e.preventDefault();
            
            const email = ELEMENTS.loginEmail.value.trim();
            const password = ELEMENTS.loginPassword.value.trim();
            
            if (!email || !password) {
                showLoginError('Please enter both email and password');
                return;
            }
            
            setLoginLoading(true);
            
            try {
                const response = await fetch(`${CONFIG.BACKEND_URL}${CONFIG.ENDPOINTS.LOGIN}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, password })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    STATE.token = data.data.token;
                    STATE.user = data.data.user;
                    
                    localStorage.setItem('rawWealthyToken', STATE.token);
                    localStorage.setItem('rawWealthyUser', JSON.stringify(data.data.user));
                    
                    // Set default credentials if "Remember me" is checked
                    if (document.getElementById('rememberMe').checked) {
                        localStorage.setItem('rememberedEmail', email);
                    }
                    
                    showApp();
                    UI.showToast('Login successful!', 'success');
                    
                    // Initialize app
                    initializeApp();
                    
                } else {
                    throw new Error(data.message || 'Login failed');
                }
            } catch (error) {
                showLoginError(error.message);
            } finally {
                setLoginLoading(false);
            }
        }

        // Logout
        async function handleLogout() {
            if (confirm('Are you sure you want to logout?')) {
                try {
                    await ApiService.post(CONFIG.ENDPOINTS.LOGOUT);
                } catch (error) {
                    // Ignore logout errors
                }
                
                localStorage.removeItem('rawWealthyToken');
                localStorage.removeItem('rawWealthyUser');
                STATE.token = null;
                STATE.user = null;
                
                showLogin();
                UI.showToast('Logged out successfully', 'info');
            }
        }

        // Navigation
        function navigateTo(page) {
            // Update navigation state
            STATE.previousPage = STATE.currentPage;
            STATE.currentPage = page;
            
            // Update active nav link
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-page') === page) {
                    link.classList.add('active');
                }
            });
            
            // Update page title
            const pageTitles = {
                'dashboard': 'Dashboard',
                'users': 'Users Management',
                'investments': 'Pending Investments',
                'deposits': 'Pending Deposits',
                'withdrawals': 'Pending Withdrawals',
                'transactions': 'Transactions',
                'kyc': 'KYC Verification',
                'support': 'Support Tickets',
                'plans': 'Investment Plans',
                'analytics': 'Analytics',
                'reports': 'Reports',
                'settings': 'Settings',
                'audit': 'Audit Log',
                'systemHealth': 'System Health',
                'profile': 'My Profile',
                'security': 'Security',
                'apiKeys': 'API Keys',
                'emailTemplates': 'Email Templates',
                'notifications': 'Notifications',
                'referrals': 'Referral System'
            };
            
            const title = pageTitles[page] || page.charAt(0).toUpperCase() + page.slice(1);
            UI.updatePageTitle(title);
            
            // Load page content
            switch (page) {
                case 'dashboard':
                    Pages.renderDashboard();
                    break;
                case 'users':
                    Pages.renderUsers();
                    break;
                case 'investments':
                    Pages.renderInvestments();
                    break;
                case 'deposits':
                    Pages.renderDeposits();
                    break;
                case 'withdrawals':
                    Pages.renderWithdrawals();
                    break;
                case 'kyc':
                    Pages.renderKYC();
                    break;
                case 'settings':
                    Pages.renderSettings();
                    break;
                case 'analytics':
                    Pages.renderAnalytics();
                    break;
                default:
                    ELEMENTS.pageContent.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <i class="fas fa-cog"></i>
                            </div>
                            <h3 class="empty-state-title">Page Under Construction</h3>
                            <p class="empty-state-description">This page is currently being developed and will be available soon.</p>
                            <button class="btn btn-primary" onclick="navigateTo('dashboard')">
                                <i class="fas fa-home"></i> Back to Dashboard
                            </button>
                        </div>
                    `;
            }
            
            // Close sidebar on mobile
            if (window.innerWidth <= 1200) {
                ELEMENTS.sidebar.classList.remove('mobile-open');
            }
        }

        // Search
        function handleGlobalSearch(value) {
            STATE.globalSearch = value;
            
            // Implement search functionality based on current page
            switch (STATE.currentPage) {
                case 'users':
                    filterUsers(value);
                    break;
                case 'investments':
                    filterInvestments(value);
                    break;
                case 'deposits':
                    filterDeposits(value);
                    break;
                case 'withdrawals':
                    filterWithdrawals(value);
                    break;
                default:
                    UI.showToast('Search functionality not available on this page', 'info');
            }
        }

        // Filter Functions
        async function filterUsers(search) {
            STATE.filters.search = search;
            await Pages.renderUsers(1);
        }

        async function filterUsersByStatus(status) {
            STATE.filters.status = status;
            await Pages.renderUsers(1);
        }

        async function filterUsersByRole(role) {
            STATE.filters.role = role;
            await Pages.renderUsers(1);
        }

        // User Actions
        async function viewUser(userId) {
            try {
                const data = await ApiService.get(CONFIG.ENDPOINTS.USER_DETAILS.replace('{id}', userId));
                
                const modalContent = `
                    <div class="space-y-4">
                        <div class="flex items-center gap-4">
                            <div class="user-avatar text-xl">${data.user?.full_name?.charAt(0) || 'U'}</div>
                            <div>
                                <h4 class="font-bold text-lg">${data.user?.full_name || 'N/A'}</h4>
                                <p class="text-gray">${data.user?.email || ''}</p>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <div class="text-sm text-gray">Phone</div>
                                <div class="font-medium">${data.user?.phone || 'N/A'}</div>
                            </div>
                            <div>
                                <div class="text-sm text-gray">Role</div>
                                <div>
                                    <span class="badge ${data.user?.role === 'super_admin' ? 'badge-primary' : data.user?.role === 'admin' ? 'badge-secondary' : 'badge-gray'}">
                                        ${data.user?.role?.replace('_', ' ').toUpperCase()}
                                    </span>
                                </div>
                            </div>
                            <div>
                                <div class="text-sm text-gray">Status</div>
                                <div class="status-indicator">
                                    <span class="status-dot status-dot-${Utils.getStatusColor(data.user?.is_active ? 'active' : 'inactive')}"></span>
                                    <span>${data.user?.is_active ? 'Active' : 'Inactive'}</span>
                                </div>
                            </div>
                            <div>
                                <div class="text-sm text-gray">KYC Status</div>
                                <div>
                                    <span class="badge badge-${Utils.getStatusColor(data.user?.kyc_status)}">
                                        ${data.user?.kyc_status?.toUpperCase() || 'NOT SUBMITTED'}
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="border-t pt-4">
                            <h5 class="font-semibold mb-2">Account Information</h5>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <div class="text-sm text-gray">Balance</div>
                                    <div class="font-medium text-lg">${Utils.formatCurrency(data.user?.balance || 0)}</div>
                                </div>
                                <div>
                                    <div class="text-sm text-gray">Total Investments</div>
                                    <div class="font-medium">${data.stats?.total_investments || 0}</div>
                                </div>
                                <div>
                                    <div class="text-sm text-gray">Total Deposits</div>
                                    <div class="font-medium">${data.stats?.total_deposits || 0}</div>
                                </div>
                                <div>
                                    <div class="text-sm text-gray">Total Withdrawals</div>
                                    <div class="font-medium">${data.stats?.total_withdrawals || 0}</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="border-t pt-4">
                            <h5 class="font-semibold mb-2">User Activity</h5>
                            <div class="space-y-2">
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray">Joined</span>
                                    <span>${Utils.formatDateTime(data.user?.createdAt)}</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray">Last Login</span>
                                    <span>${data.user?.last_login ? Utils.timeAgo(data.user.last_login) : 'Never'}</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray">Last Active</span>
                                    <span>${data.user?.last_active ? Utils.timeAgo(data.user.last_active) : 'Never'}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                UI.showModal(modalContent, {
                    title: 'User Details',
                    size: 'md',
                    footer: `
                        <button class="btn btn-primary" onclick="editUser('${userId}')">Edit User</button>
                        <button class="btn btn-outline" onclick="UI.closeModal('${STATE.activeModal}')">Close</button>
                    `
                });
                
            } catch (error) {
                UI.showToast('Failed to load user details', 'error');
            }
        }

        async function editUser(userId) {
            // Implementation for editing user
            UI.showToast('Edit user functionality coming soon', 'info');
        }

        async function toggleUserStatus(userId, isActive) {
            if (confirm(`Are you sure you want to ${isActive ? 'deactivate' : 'activate'} this user?`)) {
                try {
                    await ApiService.put(
                        CONFIG.ENDPOINTS.UPDATE_USER_STATUS.replace('{id}', userId),
                        { is_active: !isActive }
                    );
                    
                    UI.showToast(`User ${isActive ? 'deactivated' : 'activated'} successfully`, 'success');
                    await Pages.renderUsers();
                    await UI.updateBadgeCounts();
                    
                } catch (error) {
                    UI.showToast('Failed to update user status', 'error');
                }
            }
        }

        // Investment Actions
        async function approveInvestment(investmentId) {
            if (confirm('Approve this investment?')) {
                try {
                    await ApiService.post(
                        CONFIG.ENDPOINTS.APPROVE_INVESTMENT.replace('{id}', investmentId),
                        { remarks: 'Approved via admin dashboard' }
                    );
                    
                    UI.showToast('Investment approved successfully', 'success');
                    await Pages.renderInvestments();
                    await UI.updateBadgeCounts();
                    
                } catch (error) {
                    UI.showToast('Failed to approve investment', 'error');
                }
            }
        }

        async function rejectInvestment(investmentId) {
            if (confirm('Reject this investment?')) {
                // Implementation for rejecting investment
                UI.showToast('Reject investment functionality coming soon', 'info');
            }
        }

        async function viewInvestment(investmentId) {
            // Implementation for viewing investment details
            UI.showToast('View investment functionality coming soon', 'info');
        }

        // Deposit Actions
        async function approveDeposit(depositId) {
            if (confirm('Approve this deposit?')) {
                try {
                    await ApiService.post(
                        CONFIG.ENDPOINTS.APPROVE_DEPOSIT.replace('{id}', depositId),
                        { remarks: 'Approved via admin dashboard' }
                    );
                    
                    UI.showToast('Deposit approved successfully', 'success');
                    await Pages.renderDeposits();
                    await UI.updateBadgeCounts();
                    
                } catch (error) {
                    UI.showToast('Failed to approve deposit', 'error');
                }
            }
        }

        async function rejectDeposit(depositId) {
            if (confirm('Reject this deposit?')) {
                // Implementation for rejecting deposit
                UI.showToast('Reject deposit functionality coming soon', 'info');
            }
        }

        async function viewDeposit(depositId) {
            // Implementation for viewing deposit details
            UI.showToast('View deposit functionality coming soon', 'info');
        }

        function viewProof(url) {
            if (url) {
                window.open(url, '_blank');
            } else {
                UI.showToast('No proof available', 'warning');
            }
        }

        // Withdrawal Actions
        async function approveWithdrawal(withdrawalId) {
            if (confirm('Approve this withdrawal?')) {
                try {
                    await ApiService.post(
                        CONFIG.ENDPOINTS.APPROVE_WITHDRAWAL.replace('{id}', withdrawalId),
                        { 
                            transaction_id: `TRX${Date.now()}`,
                            remarks: 'Approved via admin dashboard' 
                        }
                    );
                    
                    UI.showToast('Withdrawal approved successfully', 'success');
                    await Pages.renderWithdrawals();
                    await UI.updateBadgeCounts();
                    
                } catch (error) {
                    UI.showToast('Failed to approve withdrawal', 'error');
                }
            }
        }

        async function rejectWithdrawal(withdrawalId) {
            if (confirm('Reject this withdrawal?')) {
                // Implementation for rejecting withdrawal
                UI.showToast('Reject withdrawal functionality coming soon', 'info');
            }
        }

        async function viewWithdrawal(withdrawalId) {
            // Implementation for viewing withdrawal details
            UI.showToast('View withdrawal functionality coming soon', 'info');
        }

        // KYC Actions
        async function approveKYC(kycId) {
            if (confirm('Approve this KYC submission?')) {
                try {
                    await ApiService.post(
                        CONFIG.ENDPOINTS.APPROVE_KYC.replace('{id}', kycId),
                        { remarks: 'Verified via admin dashboard' }
                    );
                    
                    UI.showToast('KYC approved successfully', 'success');
                    await Pages.renderKYC();
                    await UI.updateBadgeCounts();
                    
                } catch (error) {
                    UI.showToast('Failed to approve KYC', 'error');
                }
            }
        }

        async function rejectKYC(kycId) {
            if (confirm('Reject this KYC submission?')) {
                // Implementation for rejecting KYC
                UI.showToast('Reject KYC functionality coming soon', 'info');
            }
        }

        async function viewKYCDetails(kycId) {
            // Implementation for viewing KYC details
            UI.showToast('View KYC functionality coming soon', 'info');
        }

        function viewDocument(url) {
            if (url) {
                window.open(url, '_blank');
            } else {
                UI.showToast('Document not available', 'warning');
            }
        }

        // System Actions
        function refreshDashboard() {
            ApiService.clearCache('dashboard');
            Pages.renderDashboard();
            UI.showToast('Dashboard refreshed', 'success');
        }

        function refreshInvestments() {
            ApiService.clearCache('investments');
            Pages.renderInvestments();
            UI.showToast('Investments refreshed', 'success');
        }

        function refreshDeposits() {
            ApiService.clearCache('deposits');
            Pages.renderDeposits();
            UI.showToast('Deposits refreshed', 'success');
        }

        function refreshWithdrawals() {
            ApiService.clearCache('withdrawals');
            Pages.renderWithdrawals();
            UI.showToast('Withdrawals refreshed', 'success');
        }

        function refreshKYC() {
            ApiService.clearCache('kyc');
            Pages.renderKYC();
            UI.showToast('KYC refreshed', 'success');
        }

        function refreshAllData() {
            ApiService.clearCache();
            navigateTo(STATE.currentPage);
            UI.showToast('All data refreshed', 'success');
        }

        function clearCache() {
            ApiService.clearCache();
            localStorage.removeItem('sidebarCollapsed');
            localStorage.removeItem('darkMode');
            UI.showToast('Cache cleared successfully', 'success');
        }

        function backupDatabase() {
            UI.showToast('Database backup functionality coming soon', 'info');
        }

        function showApiKeys() {
            UI.showToast('API keys functionality coming soon', 'info');
        }

        function showSystemLogs() {
            UI.showToast('System logs functionality coming soon', 'info');
        }

        function maintenanceMode() {
            if (confirm('Enable maintenance mode? This will make the platform unavailable to users.')) {
                UI.showToast('Maintenance mode functionality coming soon', 'info');
            }
        }

        function clearAllData() {
            if (confirm('WARNING: This will delete ALL data. This action cannot be undone. Are you sure?')) {
                if (prompt('Type "DELETE ALL" to confirm:') === 'DELETE ALL') {
                    UI.showToast('Clear all data functionality coming soon', 'info');
                }
            }
        }

        function resetSystem() {
            if (confirm('Reset system to default settings?')) {
                UI.showToast('System reset functionality coming soon', 'info');
            }
        }

        function exportUsers() {
            UI.showToast('Export users functionality coming soon', 'info');
        }

        function exportAnalytics() {
            UI.showToast('Export analytics functionality coming soon', 'info');
        }

        function changeAnalyticsPeriod(period) {
            UI.showToast(`Analytics period changed to ${period}`, 'info');
            // Implementation for changing analytics period
        }

        function filterDashboard(search) {
            UI.showToast('Dashboard search functionality coming soon', 'info');
        }

        // Create User Modal
        function showCreateUserModal() {
            const modalContent = `
                <form id="createUserForm" onsubmit="createUser(event)">
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="newUserName" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" class="form-control" id="newUserEmail" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Phone Number</label>
                        <input type="tel" class="form-control" id="newUserPhone" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-control" id="newUserPassword" required>
                        <div class="form-hint">Minimum 6 characters</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Role</label>
                        <select class="form-select" id="newUserRole">
                            <option value="user">User</option>
                            <option value="admin">Admin</option>
                            <option value="super_admin">Super Admin</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Initial Balance (₦)</label>
                        <input type="number" class="form-control" id="newUserBalance" value="0" min="0">
                    </div>
                    <div class="form-group">
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="newUserActive" checked>
                            <label class="form-check-label" for="newUserActive">Active Account</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="newUserVerified" checked>
                            <label class="form-check-label" for="newUserVerified">Email Verified</label>
                        </div>
                    </div>
                </form>
            `;
            
            UI.showModal(modalContent, {
                title: 'Create New User',
                footer: `
                    <button type="submit" form="createUserForm" class="btn btn-primary">Create User</button>
                    <button type="button" class="btn btn-outline" onclick="UI.closeModal('${STATE.activeModal}')">Cancel</button>
                `
            });
        }

        async function createUser(e) {
            e.preventDefault();
            
            const userData = {
                full_name: document.getElementById('newUserName').value,
                email: document.getElementById('newUserEmail').value,
                phone: document.getElementById('newUserPhone').value,
                password: document.getElementById('newUserPassword').value,
                role: document.getElementById('newUserRole').value,
                balance: parseFloat(document.getElementById('newUserBalance').value) || 0,
                is_active: document.getElementById('newUserActive').checked,
                is_verified: document.getElementById('newUserVerified').checked
            };
            
            try {
                await ApiService.post(CONFIG.ENDPOINTS.CREATE_USER, userData);
                UI.closeModal(STATE.activeModal);
                UI.showToast('User created successfully', 'success');
                await Pages.renderUsers();
                await UI.updateBadgeCounts();
                
            } catch (error) {
                UI.showToast(`Failed to create user: ${error.message}`, 'error');
            }
        }

        // Notification Functions
        async function markNotificationAsRead(notificationId) {
            try {
                await ApiService.post(
                    CONFIG.ENDPOINTS.MARK_NOTIFICATION_READ.replace('{id}', notificationId)
                );
                await UI.updateNotifications();
            } catch (error) {
                console.error('Failed to mark notification as read:', error);
            }
        }

        async function markAllNotificationsAsRead() {
            try {
                await ApiService.post(CONFIG.ENDPOINTS.MARK_ALL_READ);
                await UI.updateNotifications();
                UI.showToast('All notifications marked as read', 'success');
            } catch (error) {
                UI.showToast('Failed to mark notifications as read', 'error');
            }
        }

        // ==================== INITIALIZATION ====================
        function initializeApp() {
            // Update UI based on state
            UI.updateUserInfo(STATE.user);
            
            if (STATE.sidebarCollapsed) {
                ELEMENTS.sidebar.classList.add('collapsed');
                ELEMENTS.mainContent.classList.add('expanded');
                ELEMENTS.toggleSidebar.innerHTML = '<i class="fas fa-chevron-right"></i>';
            }
            
            if (STATE.darkMode) {
                document.body.classList.add('dark-mode');
                ELEMENTS.darkModeToggle.checked = true;
            }
            
            // Set up event listeners
            setupEventListeners();
            
            // Load initial page
            navigateTo(STATE.currentPage);
            
            // Start background updates
            startBackgroundUpdates();
        }

        function setupEventListeners() {
            // Login form
            ELEMENTS.loginForm.addEventListener('submit', handleLogin);
            
            // Sidebar toggle
            ELEMENTS.toggleSidebar.addEventListener('click', UI.toggleSidebar);
            
            // Mobile menu toggle
            ELEMENTS.mobileMenuToggle.addEventListener('click', () => {
                ELEMENTS.sidebar.classList.toggle('mobile-open');
            });
            
            // Navigation links
            document.querySelectorAll('.nav-link[data-page]').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const page = link.getAttribute('data-page');
                    navigateTo(page);
                });
            });
            
            // Global search
            ELEMENTS.globalSearch?.addEventListener('input', Utils.debounce((e) => {
                handleGlobalSearch(e.target.value);
            }, 300));
            
            // User menu toggle
            ELEMENTS.userMenu.querySelector('.user-menu-toggle').addEventListener('click', () => {
                ELEMENTS.userMenu.classList.toggle('open');
            });
            
            // Notifications toggle
            ELEMENTS.notifications.querySelector('.notifications-toggle').addEventListener('click', () => {
                ELEMENTS.notifications.classList.toggle('open');
            });
            
            // Mark all notifications as read
            ELEMENTS.markAllRead.addEventListener('click', markAllNotificationsAsRead);
            
            // Logout
            ELEMENTS.logoutButton.addEventListener('click', handleLogout);
            
            // Dark mode toggle
            ELEMENTS.darkModeToggle.addEventListener('change', UI.toggleDarkMode);
            
            // Close dropdowns when clicking outside
            document.addEventListener('click', (e) => {
                if (!ELEMENTS.userMenu.contains(e.target)) {
                    ELEMENTS.userMenu.classList.remove('open');
                }
                if (!ELEMENTS.notifications.contains(e.target)) {
                    ELEMENTS.notifications.classList.remove('open');
                }
            });
            
            // Handle keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                // Ctrl/Cmd + K for search
                if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                    e.preventDefault();
                    ELEMENTS.globalSearch?.focus();
                }
                
                // Escape to close modals
                if (e.key === 'Escape') {
                    if (STATE.activeModal) {
                        UI.closeModal(STATE.activeModal);
                    }
                }
                
                // Alt + D for dashboard
                if (e.altKey && e.key === 'd') {
                    e.preventDefault();
                    navigateTo('dashboard');
                }
                
                // Alt + U for users
                if (e.altKey && e.key === 'u') {
                    e.preventDefault();
                    navigateTo('users');
                }
            });
            
            // Handle window resize
            window.addEventListener('resize', Utils.throttle(() => {
                if (window.innerWidth > 1200) {
                    ELEMENTS.sidebar.classList.remove('mobile-open');
                }
            }, 250));
        }

        function startBackgroundUpdates() {
            // Update badge counts every 30 seconds
            setInterval(UI.updateBadgeCounts, 30000);
            
            // Update notifications every minute
            setInterval(UI.updateNotifications, 60000);
            
            // Refresh current page data every 5 minutes
            setInterval(() => {
                if (STATE.currentPage && !STATE.isLoading) {
                    ApiService.clearCache(STATE.currentPage);
                    navigateTo(STATE.currentPage);
                }
            }, 300000);
            
            // Check backend health every minute
            setInterval(async () => {
                try {
                    await fetch(`${CONFIG.BACKEND_URL}/health`);
                } catch (error) {
                    UI.showToast('Backend connection issue detected', 'warning');
                }
            }, 60000);
        }

        function showLogin() {
            ELEMENTS.loginPage.classList.remove('hidden');
            ELEMENTS.appContainer.classList.add('hidden');
            
            // Pre-fill remembered email
            const rememberedEmail = localStorage.getItem('rememberedEmail');
            if (rememberedEmail) {
                ELEMENTS.loginEmail.value = rememberedEmail;
                document.getElementById('rememberMe').checked = true;
            }
        }

        function showApp() {
            ELEMENTS.loginPage.classList.add('hidden');
            ELEMENTS.appContainer.classList.remove('hidden');
        }

        function showLoginError(message) {
            ELEMENTS.errorMessage.textContent = message;
            ELEMENTS.loginError.classList.remove('hidden');
            
            setTimeout(() => {
                ELEMENTS.loginError.classList.add('hidden');
            }, 5000);
        }

        function setLoginLoading(isLoading) {
            ELEMENTS.loginButton.disabled = isLoading;
            ELEMENTS.loginButtonText.style.display = isLoading ? 'none' : 'inline';
            ELEMENTS.loginButtonSpinner.style.display = isLoading ? 'inline' : 'none';
        }

        // ==================== INITIAL LOAD ====================
        document.addEventListener('DOMContentLoaded', () => {
            // Check for saved token
            if (STATE.token && STATE.user) {
                // Verify token
                ApiService.get(CONFIG.ENDPOINTS.PROFILE)
                    .then(() => {
                        showApp();
                        initializeApp();
                    })
                    .catch(() => {
                        localStorage.removeItem('rawWealthyToken');
                        localStorage.removeItem('rawWealthyUser');
                        showLogin();
                    });
            } else {
                showLogin();
            }
            
            // Add mobile menu toggle for responsive design
            if (window.innerWidth <= 1200) {
                ELEMENTS.mobileMenuToggle.classList.remove('hidden');
            }
            
            // Initialize tooltips
            document.addEventListener('mouseover', (e) => {
                if (e.target.hasAttribute('title')) {
                    const tooltip = document.createElement('div');
                    tooltip.className = 'tooltip';
                    tooltip.textContent = e.target.getAttribute('title');
                    document.body.appendChild(tooltip);
                    
                    const rect = e.target.getBoundingClientRect();
                    tooltip.style.left = rect.left + (rect.width / 2) + 'px';
                    tooltip.style.top = rect.top - 5 + 'px';
                    
                    tooltip.classList.add('show');
                    
                    e.target.addEventListener('mouseleave', () => {
                        tooltip.remove();
                    }, { once: true });
                }
            });
        });

        // ==================== GLOBAL EXPORTS ====================
        // Make functions available globally
        window.navigateTo = navigateTo;
        window.refreshDashboard = refreshDashboard;
        window.refreshInvestments = refreshInvestments;
        window.refreshDeposits = refreshDeposits;
        window.refreshWithdrawals = refreshWithdrawals;
        window.refreshKYC = refreshKYC;
        window.refreshAllData = refreshAllData;
        window.clearCache = clearCache;
        window.viewUser = viewUser;
        window.editUser = editUser;
        window.toggleUserStatus = toggleUserStatus;
        window.approveInvestment = approveInvestment;
        window.rejectInvestment = rejectInvestment;
        window.viewInvestment = viewInvestment;
        window.approveDeposit = approveDeposit;
        window.rejectDeposit = rejectDeposit;
        window.viewDeposit = viewDeposit;
        window.viewProof = viewProof;
        window.approveWithdrawal = approveWithdrawal;
        window.rejectWithdrawal = rejectWithdrawal;
        window.viewWithdrawal = viewWithdrawal;
        window.approveKYC = approveKYC;
        window.rejectKYC = rejectKYC;
        window.viewKYCDetails = viewKYCDetails;
        window.viewDocument = viewDocument;
        window.backupDatabase = backupDatabase;
        window.showApiKeys = showApiKeys;
        window.showSystemLogs = showSystemLogs;
        window.maintenanceMode = maintenanceMode;
        window.clearAllData = clearAllData;
        window.resetSystem = resetSystem;
        window.exportUsers = exportUsers;
        window.exportAnalytics = exportAnalytics;
        window.changeAnalyticsPeriod = changeAnalyticsPeriod;
        window.filterDashboard = filterDashboard;
        window.filterUsers = filterUsers;
        window.filterUsersByStatus = filterUsersByStatus;
        window.filterUsersByRole = filterUsersByRole;
        window.showCreateUserModal = showCreateUserModal;
        window.createUser = createUser;
        window.markNotificationAsRead = markNotificationAsRead;
        window.markAllNotificationsAsRead = markAllNotificationsAsRead;
        window.loadUsersPage = (page) => Pages.renderUsers(page);
        window.Pages = Pages;
        window.Utils = Utils;
        window.UI = UI;
        window.ApiService = ApiService;
    </script>
</body>
</html>
